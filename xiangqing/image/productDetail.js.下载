/* SVN.committedRevision=f279392 */
$(function(){$("body").lazyImg({load:false,indexLoad:true,scrollLoad:true})});var YhdImgUtil={};YhdImgUtil.getYhdImgUrlBySize=function(k,n,e){if(!k||!n||!e){return k}var o=/\/s\d{1,}x\d{1,}_/;if(o.test(url)){return k}try{var j=k.split(".");var p=j[2].split("/");var l=p[2];p[2]=["s",n,"x",e,"_"+l].join("");j[2]=p.join("/");return j.join(".")}catch(m){return k}};YhdImgUtil.getYhdImgUrlByPath=function(n,l,e,j,i){if(!j||!l||!e){return""}if(i==1){return"//m.360buyimg.com/n1/s"+l+"x"+e+"_"+j}try{var m;n=n?n:0;switch(n%5){case 0:m=10;break;case 1:m=11;break;case 2:m=12;break;case 3:m=13;break;case 4:m=14;break;default:m=10}return"//img"+m+".360buyimg.com/n1/s"+l+"x"+e+"_"+j}catch(k){return""}};var store=(function(){var d={},f=window,e=f.document,c="localStorage",b="globalStorage",g;d.set=function(h,i){};d.get=function(h){};d.remove=function(h){};d.clear=function(){};if(e.documentElement.addBehavior){function a(){if(!(!+[1])){if(g){return g}}g=e.body.appendChild(e.createElement("div"));g.style.display="none";g.addBehavior("#default#userData");g.load(c);return g}d.set=function(h,i){var j=a();j.setAttribute(h,i);j.save(c)};d.get=function(h){var i=a();return i.getAttribute(h)};d.remove=function(h){var i=a();i.removeAttribute(h);i.save(c)};d.clear=function(){var l=a();var j=l.XMLDocument.documentElement.attributes;l.load(c);for(var k=0,h;h=j[k];k++){l.removeAttribute(h.name)}l.save(c)}}else{if(c in f&&f[c]){g=f[c];d.set=function(h,i){g.setItem(h,i)};d.get=function(h){return g.getItem(h)
};d.remove=function(h){g.removeItem(h)};d.clear=function(){g.clear()}}else{if(b in f&&f[b]){g=f[b][f.location.hostname];d.set=function(h,i){g[h]=i};d.get=function(h){return g[h]&&g[h].value};d.remove=function(h){delete g[h]};d.clear=function(){for(var h in g){delete g[h]}}}}}return d})();function arrayToJsonStr(c){var b=[];if(typeof c=="string"){return'"'+c.replace(/([\'\"\\])/g,"\\$1").replace(/(\n)/g,"\\n").replace(/(\r)/g,"\\r").replace(/(\t)/g,"\\t")+'"'}if(typeof c=="object"){if(!c.sort){for(var a in c){b.push(a+":"+arrayToJsonStr(c[a]))}if(!!document.all&&!/^\n?function\s*toString\(\)\s*\{\n?\s*\[native code\]\n?\s*\}\n?\s*$/.test(c.toString)){b.push("toString:"+c.toString.toString())}b="{"+b.join()+"}"}else{for(var a=0;a<c.length;a++){b.push(arrayToJsonStr(c[a]))}b="["+b.join()+"]"}return b
}return c.toString()}function jsonStrToArray(o){return eval("("+o+")")};var detailTrack={saveTrack2LS:function(){loginRelated.checkLoginStatus(function(a){var c=a?1:0;if(a){detailTrack.addLSTrack2Cache();c=1}var b={};b.skuId=detailParams.skuId;b.accessTime=new Date().getTime();b.syncServ=c;detailTrack.setTrack2LS(b)})},setTrack2LS:function(d){if(!d){return}var a=JSON.stringify(d);var c=store.get("trackStore");var b=[];if(c){b=jsonStrToArray(c);b.push(a)}else{b.push(a)}store.set("trackStore",arrayToJsonStr(b))},addLSTrack2Cache:function(){var e=store.get("trackStore");if(e){var b=jsonStrToArray(e);var d=[];for(var a=0;a<b.length;a++){var c=JSON.parse(b[a]);if(!c.syncServ){d.push(c)}}if(d&&d.length==0){return}detailTrack.addTrack2Cache(d,function(){for(var f=0;f<b.length;f++){var g=JSON.parse(b[f]);if(!g.syncServ){g.syncServ=1}b[f]=JSON.stringify(g)}store.set("trackStore",arrayToJsonStr(b))
})}},addTrack2Cache:function(b,d){var a=URLPrefix.detailDomainAjax+"/addLSTrackInfo2Cache.do";var c={extParam:JSON.stringify(b).replace(/([\'\"])/g,"*")};$.ajax({type:"get",url:a,data:c,dataType:"jsonp",jsonp:"callback",timeout:6000,success:function(e){if(e&&e.code===0&&typeof d=="function"){d()}},error:function(){console.log("addLSTrackInfo2Cache error")}})},distinctAndLimitNum4LS:function(c){if(c){var a=jsonStrToArray(c);a.length();for(var b in a){}}}};var loginRelated={ajaxCheckLoginStatus:function(a){$.ajax({url:URLPrefix.detailDomainAjax+"/ajaxCheckLoginStatus.do?callback=?",type:"GET",dataType:"jsonp",timeout:2000,success:function(b){if(b&&b.code==1){a(true)}else{a(false)}},error:function(b,d,c){a(false)}})},checkLoginStatus:function(a){loli.globalCheckLogin(function(b){if(b&&b.result==1){yhdPublicLogin.showTopLoginInfo();if(typeof a=="function"){a(true)}}else{if(typeof a=="function"){a(false)}}})},checkAndLogin:function(a){loli.globalCheckLogin(function(b){if(b&&b.result==1){yhdPublicLogin.showTopLoginInfo();if(typeof a=="function"){a()}}else{yhdPublicLogin.showLoginDivNone(URLPrefix.passport,false,"",function(c){if(c==0){yhdPublicLogin.showTopLoginInfo();loginRelated.loginSuccessCommonCallback();if(typeof a=="function"){a()}}})}})},getUserInfo:function(a){$.ajax({url:URLPrefix.detailDomainAjax+"/ajaxGetUserInfo.do?callback=?",type:"GET",dataType:"json",success:function(b){if(b&&b.code!=1){return
}if(a&&typeof a=="function"){a(b.data)}}})},getUserNotifyPhone:function(a){$.ajax({url:URLPrefix.detailDomainAjax+"/ajaxGetUserNotifyPhone.do?callback=?",type:"GET",dataType:"json",success:function(b){if(b&&b.code!=0){return}if(a&&typeof a=="function"){a(b.data)}}})},loginSuccessCommonCallback:function(){detailSku.getStockAndPriceCheckLogin();detailSku.followProduct.followStatus()}};var detailPublic={popmeun:function(f,d,h,e){if($(f).length<1){return false}var g=$(f);var b=($.browser&&$.browser.msie&&parseInt($.browser.version,10)==6)||(window.ActiveXObject&&!window.XMLHttpRequest);var a=$("#mask");function c(){var i=g.find(".jsclose");i.bind("click",function(){g.hide().removeAttr("style");a.hide();if(h&&typeof h=="function"){h()}})}c();$(window).scroll(function(){var i=$(window).scrollTop();if(b){g.css({top:i})}});if(d&&$(d)){$(d).unbind("click").bind("click",function(){var i=$(window).height();var j=$(window).scrollTop();var k=g.outerHeight();if(k>=i){g.css({position:"absolute",top:j+"px",marginTop:0})}g.show();a.show()})}else{g.show();a.show()}if($(e).length>0){setTimeout(function(){g.hide();a.hide()},e)}},isPc:function(){var a=navigator.userAgent;var d=new Array("Windows Phone","iPad");
var b=true;for(var c=0;c<d.length;c++){if(a.indexOf(d[c])>0){b=false;break}}return b},popMeun2:function(a){this.popmeun(a)},popMeun3:function(a,b){this.popmeun(a,null,b)},checkAndLogin:function(a){detailTools.ajaxCheckLoginStatus(function(b){if(b){if(typeof a=="function"){a()}}else{yhdPublicLogin.showLoginDivNone(URLPrefix.passport,false,"",function(c){if(c==0){yhdPublicLogin.showTopLoginInfo();if(typeof a=="function"){a()}}})}})},getUserInfo:function(a){jQuery.ajax({url:URLPrefix.detailDomainAjax+"/ajaxGetUserInfo.do?callback=?",type:"GET",dataType:"json",success:function(b){if(b&&b.code!=1){return}if(a&&typeof a=="function"){a(b.data)}}})},checkUserGoRealName:function(b){var a=URLPrefix.detailDomainAjax+"/checkUserRealName.do";$.ajax({type:"get",url:a,dataType:"jsonp",data:{},jsonp:"callback",timeout:1000,success:function(c){if(c&&!c.code){b(true)
}else{b(false)}},error:function(){b(false)}})}};var detailUtil={lazyLoadFunc:function(e,d,f){f=f||50;var b=function(g){if(jQuery(g).length==0){return 0}else{return jQuery(g).offset().top}};var a=b(e);if(detailUtil.getPageTop()<a+f){var c=function(){var g=b(e);if(detailUtil.getPageTop()>=g+f){d();$(window).unbind("scroll",c)}};$(window).bind("scroll",c)}else{d()}},getPageTop:function(){var e=document,a=e.documentElement,d=e.body,b=Math.max(a.scrollTop,d.scrollTop),c=a.clientHeight+b;return c},qrcodeInit:function(c,b){var a=detailPath.mobileDomain||"http://m.yhd.com";requirejs(["qrcode"],function(){new QRCode("appDownload",{text:a+"/scanCode?"+b,width:60,height:60,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.L})})},objHover:function(b,a){var c=$(b);c.hover(function(){$(this).addClass(a)},function(){$(this).removeClass(a)
})},posttoWb:function(){var f=encodeURI(document.title);var c=encodeURI(window.location);var e="2fc26c2514bb48ec891170ce68db2683";var a=encodeURI;var b="";var d="http://v.t.qq.com/share/share.php?title="+f+"&url="+c+"&appkey="+e+"&site="+a+"&pic="+b;window.open(d,"转播到腾讯微博","width=700, height=580, top=180, left=320, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no")},dzdposttoWb:function(){var f=encodeURI(document.title+" 1号商城，品质保证，网上优选 ");var c=encodeURI(window.location);var e="2fc26c2514bb48ec891170ce68db2683";var a=encodeURI;var b="";var d="http://v.t.qq.com/share/share.php?title="+f+"&url="+c+"&appkey="+e+"&site="+a+"&pic="+b;window.open(d,"转播到腾讯微博","width=700, height=580, top=180, left=320, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no")
},codeShow:function(){$(".qr_Code").hover(function(){$(this).find(".qr_Code_K").show()},function(){$(this).find(".qr_Code_K").hide()})},displayQRCode:function(b){var a=detailPath.mobileDomain||"http://m.yhd.com";requirejs(["qrcode"],function(e){var d=new QRCode(b,{text:a+"/scanCode?url=http://item.m.yhd.com/item/"+detailparams.pmId+"&tp=15."+detailparams.pmId+".3186.0.0",width:120,height:120,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.L});$("#"+b).attr("title","");var c=$("#"+b).find("table");if(c.size()>0){c[0].style.margin="12"}})},mobilePrice:function(c){var a=$(".mod_detail_chat"),b=a.find(".inBox");if(!detailPublic.isPc()){b.append(" <b class='iconDetail' style='position:absolute; top:0; right:0;' >&#xe617;</b>");a.on("click",function(){b.toggle().parent().css({"z-index":"99"})
})}else{a.on("mouseenter",function(){a.css({"z-index":"99"});b.fadeIn()}).on("mouseleave",function(){a.css({"z-index":"1"});b.hide()})}}};var cookieUtil={defaultPath:"/",defaultExpires:365,domain:"yhd.com",getCookie:function(a){return $.cookie(a)},getYhdAreasCookie:function(){var a=cookieUtil.getCookie(detail_yhdareas_cookie);return a},getYhdUsualAddressIdByCookie:function(){var a=cookieUtil.getCookie(detail_yhdUsualAddress_cookie);var b;if(a){b=a.split("_")}return b},setCookie:function(b,c,a,d){d=d||this.defaultPath;a=a||this.defaultExpires;$.cookie(b,c,{domain:cookieUtil.domain,path:d,expires:a})},setYhdAreasCookie:function(b){cookieUtil.setCookie("provinceId",b.split("_")[0]);cookieUtil.setCookie("cityId",b.split("_")[1]);var a=cookieUtil.getYhdAreasCookie();if(b!=a){cookieUtil.setCookie(detail_yhdareas_cookie,b);
cookieUtil.setCookie(detail_yhdUsualAddress_cookie,"")}},setYhdUsualAddressCookie:function(a){if(a!=null){if(a.provinceId!=null&&a.cityId!=null&&a.countyId!=null&&a.townId!=null){cookieUtil.setCookie(detail_yhdareas_cookie,a.provinceId+"_"+a.cityId+"_"+a.countyId+"_"+a.townId)}if(a.longitude!=null&&a.latitude!=null){cookieUtil.setCookie(detail_yhdUsualAddress_cookie,a.id+"_"+a.gcLng+"_"+a.gcLat)}}}};var timeUtil={split:function(a){if(!a){return[]}var b=new Date(a);return[b.getFullYear(),b.getMonth()+1,b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds()]},format:function(d,c){var a=[];if(!d){return""}for(var b=0;b<d.length;b++){a.push(function(e){return e<10?("0"+e):e}(d[b]));if(c&&c[b]){a.push(c[b])}}return a.join("")},sub:function(e,c){var f=c-e;if(f<0){return[]}var a=parseInt(f/3600000);
var d=parseInt((f-a*3600000)/60000);var b=parseInt((f-(a*3600000+d*60000))/1000);return[a,d,b]},subDay:function(e,c){var g=c-e;if(g<0){return[]}var f=parseInt(g/(3600000*24));var a=parseInt((g-f*3600000*24)/3600000);var d=parseInt((g-(f*3600000*24+a*3600000))/60000);var b=parseInt((g-(f*3600000*24+a*3600000+d*60000))/1000);return[f,a,d,b]}};var numberUtil={isInt:function(a){if(isNaN(parseInt(a))){return false}return true}};var validUtil={isPhoneStr:function(a){return/^\d{11}$/.test(a)},isPriceStr:function(a){return/^(\d+\.{0,1}\d{0,2})$/.test(a)&&a.length<=13}};var popupUtil={successPopup:function(b){var a='<div class="msgBxShow"><i class="icon_tips icon_success"></i><span id="error_popwin">'+b+'</span></div><p class="pop_btn_box"><button id="close_tcg" class="close_tcg">确定</button></p>';yhdLib.popwin({popcontent:a,outareaclose:true})
}};var commonUtil={nameSpace:function(){var b=arguments[0],c=null;if(typeof b=="string"){a(b)}return c;function a(h){var f,e,d,g;d=h.split(".");g=d[0];if(window[g]===undefined){window[g]={}}c=window[g];for(f=1;f<d.length;f++){e=d[f];if(c[e]===undefined){c[e]={}}c=c[e]}}},log:function(a){if(window.console){console.log(a)}}};var fingerPrintUtil={shshshfpInit:function(){$.ajax({url:"//h5.360buyimg.com/ws_js/jdwebm.js?v=yhd",dataType:"jsonp",success:function(){}})},eidInit:function(){$.ajax({url:URLPrefix.detailDomainAjax+"/getUserEncodePin.do",dataType:"jsonp",success:function(a){if(!a||a.code!==0||!a.data){return}window.jd_jr_td_risk_pin=a.data;var b=document.createElement("script");b.type="text/javascript";b.src="//gias.jd.com/js/td.js";document.getElementsByTagName("body")[0].appendChild(b)
}})},getEid:function(){var a="";try{getJdEid(function(c){a=c})}catch(b){}return a},getUdFp:function(){var a="";try{getJdEid(function(c,d){a=d})}catch(b){}return a}};var btnStatusSet={targetId:"",getbtnStatus:function(d,a){if(!a){var b=detailParams.spAttr;if(b&&b.isYuShou&&b.isYuShou=="1"){return 2}if(detailSku.isReserveBuyProduct()){return 3}}var c=d.StockState&&$.inArray(d.StockState,[33,36,39,40])>-1;if(!c){return 1}return 0},getOneKeyGoBtnStatus:function(c){if(detailSku.mobileKo&&detailSku.mobileKo.status){detailParams.isOneKeyGo=2}var a=detailParams.isOneKeyGo;var b=c.StockState&&$.inArray(c.StockState,[33,36,39,40])>-1;if(a==1){if(b){return 1}else{return 2}}else{return 0}},setOneKeyGoBtn:function(a){if(detailSku.mobileKo&&detailSku.mobileKo.status){a=0}switch(a){case 1:btnStatusSet.addBalanceEvent();break;case 2:var c=$("#addCart");var b=$("#sellOut");if(c.is(":hidden")&&b.is(":hidden")){$("#sellOut").show()}break;default:break}},addBalanceEvent:function(){var a=$("#oneKeyGoBtn");
a.addClass("btn_init_class");a.attr("btn_init_flag","1");a.show();a.unbind().bind("click",function(){loginRelated.checkAndLogin(btnStatusSet.clickSettleAccountsItem)})},checkMobileKo:function(c){var b={"params.skuId":detailParams.skuId};var a=URLPrefix.detailDomainAjax+"/getKoInfo.do";$.ajax({type:"get",url:a,dataType:"jsonp",data:b,jsonp:"callback",timeout:5000,success:function(d){if(d&&d.data){var e=d.data;detailSku.mobileKo.status=e.status;detailSku.mobileKo.shiming=e.shiming;detailSku.mobileKo.koId=e.koId}c()},error:function(){c()}})},setAddCartButton:function(a){switch(a){case 0:if(detailSku.mobileKo&&detailSku.mobileKo.status){btnStatusSet.realNameEvent();btnStatusSet.seckillCartEvent()}else{btnStatusSet.addCartEvent()}break;case 1:btnStatusSet.noGoodsPms();break}},setSpecilAddCartButton:function(b,a){switch(b){case 2:detailRequireFunction.detailPresell(a);
break;case 3:detailSku.handleReserveBuyProduct(a);break}},addCartEvent:function(){detailSku.resetBtnStauts();$("#addCart").show();$("#addCart").attr("btn_init_flag","1");$("#addCart").unbind();jQuery("#detail_desc_addCartBtn_fixed").show();jQuery("#detail_desc_addCartBtn_fixed").unbind();require(["common_cart"],function(b){$("#addCart, #detail_desc_addCartBtn_fixed").bind("click",function(){var c=btnStatusSet.handleDidParam();var d={pid:detailParams.skuId,ptype:"1",pcount:$("#product_amount").val(),sku:"",did:c,zids:"",gids:"",targetId:btnStatusSet.targetId};b.addToCart(d);log("AddToCartYhd","ProductYhd",detailParams.skuId)})});var a=$("#J_fixedDes");a.delegate(".des_buy","mouseenter mouseleave",function(){if(!$(this).hasClass("hover")){if($("#J_fixedDes").find("img").attr("src")==""){var b=$("#J_prodImg").attr("original_src");
var c=YhdImgUtil.getYhdImgUrlByPath(detailParams.skuId,115,115,b,0);$("#J_fixedDes").find("img").attr("src",c)}}$(this).toggleClass("hover")})},handleDidParam:function(){var a=$("#freeload_service li.selected");if(a.length>0&&a.attr("data-id")){return a.attr("data-id")}return""},collectSearchSelectPromParam:function(){var a=loli.yhdStore;if(a){a.getFromRoot("search_promotion_history",function(f){if(f&&f.status==1&&f.value){var j=f.value;var b=j.split(",");for(var d=0;d<b.length;d++){var h=b[d].split("||");try{var c=h[0];if(detailParams.skuId==c){btnStatusSet.targetId=h[1];break}}catch(g){}}}})}},addSubFlow:function(){var b=btnStatusSet.handleDidParam();var a=URLPrefix.cartDomain+"/cart/opt/addSubFlow.do?wids="+detailParams.skuId+"&nums="+$("#product_amount").val()+"&subType=32&did="+b+"&targetId="+btnStatusSet.targetId;
$.ajax({url:a,type:"get",dataType:"jsonp",timeout:2000,jsonp:"callback",success:function(c){if(c&&c.code=="00000000"&&c.data&&c.data.returnUrl){window.location.href=c.data.returnUrl}else{if(c.msg){yhdLib.alert(c.msg)}else{yhdLib.alert("系统开小差了，请稍后再试~")}}},error:function(c){yhdLib.alert("系统开小差了，请稍后再试~");console.log("load stock error")}})},realNameEvent:function(){if(detailSku.mobileKo&&detailSku.mobileKo.shiming){detailPublic.checkUserGoRealName(function(c){if(!c){var b=$(".realname_check");b.find(".pop_container p").text("购买该商品需要实名认证");b.find(".pop_btn .cancel").text("取消");detailPublic.popmeun(".realname_check","#virtualBtnForRealName");var a="//home.yhd.com/safecenter/editIdentity.do?identitySource=identityProductDetail&callbackSuccUrl="+encodeURIComponent(window.location.href);$("#go_realname").attr("href",a);
$("#needShiming").bind("click",function(){loginRelated.checkAndLogin(function(){window.location=a})});$("#realnameWarnDiv").show()}else{$("#realnameWarnDiv").hide()}})}},seckillCartEvent:function(b){if(detailSku.mobileKo&&!detailSku.mobileKo.status){return}var a=$("#koCart");a.addClass("btn_init_class");a.attr("btn_init_flag","1");switch(detailSku.mobileKo.status){case 1:a.show();a.unbind("click").bind("click",function(){var d=btnStatusSet.handleDidParam();var c=URLPrefix.seckillCartDomain+"/shopping/order/getOrderInfo.do?skuId="+detailParams.skuId+"&seckillId="+detailSku.mobileKo.koId+"&num=1&did="+d+"&targetId="+btnStatusSet.targetId;detailSku.mobileKo.seckillUrl=c;loginRelated.checkAndLogin(function(){if(detailSku.mobileKo&&detailSku.mobileKo.shiming){detailPublic.checkUserGoRealName(function(e){if(e){$("#realnameWarnDiv").hide();
if(typeof b=="function"){b()}else{window.location=c}}else{document.getElementById("virtualBtnForRealName").click()}})}else{$("#realnameWarnDiv").hide();if(typeof b=="function"){b()}else{window.location=c}}})});break;case 2:case 3:a.removeClass("buy_btn5").addClass("buy_btn3").show();break}},noGoodsPms:function(){detailSku.resetBtnStauts();$("#sellOut").show();detailPmsRecomm.ajaxPersonalizationPms("noGoods");$("#sellOut").attr("btn_init_flag","1")},clickSettleAccountsItem:function(){var a=btnStatusSet.handleDidParam();var b={pid:detailParams.skuId,ptype:"1",pcount:$("#product_amount").val(),targetId:"",packId:"",gids:"",zids:"",did:a,targetId:btnStatusSet.targetId};btnStatusSet._toSettleAccountsItem(b)},_toSettleAccountsItem:function(b){var a="//cart.yhd.com/cart/opt/easyBuy.do";var c={easyBuy:1,pid:b.pid,pcount:b.pcount,ptype:b.ptype||1,targetId:b.targetId||"",packId:b.packId||"",gids:b.gids||"",zids:b.zids||"",did:b.did||""};
jQuery.ajax({url:a,data:c,dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonp"+new Date().getTime(),cache:false,timeout:5000,success:function(d){if(d&&d.code){var e;switch(d.code){case"00000000":e="操作成功";break;case"60000001":e="无效商品";break;case"60000002":e="未选中商品";break;case"60000003":e="商品无库存";break;case"60000004":e="无满足的虚拟套装规则";break;case"60000005":e="操作太频繁";break;case"99999999":e="系统异常";break}}e=e||"系统异常";if(d.code=="00000000"){if(d.data!=null&&d.data.returnUrl!=null){window.location.href=d.data.returnUrl}else{yhdLib.alert("进入结算页失败...")}}else{yhdLib.alert(e)}},error:function(d,f,e){yhdLib.alert("进入结算页失败")}})},setStoreNotifyBtn:function(a,f){if(a==2||a==3){return}var c=f.StockState&&$.inArray(f.StockState,[33,36,39,40])>-1;if(!c){var d=$("#sellOut");var e=$("#storeNotifyBtn");var b=$("#subscriberPhone");
if(detailParams.canSale==1&&detailParams.spAttr&&detailParams.spAttr.storeSubscriber==1){d.hide();e.show();$("#subscriberCloseIcon").bind("click",function(){btnStatusSet.hideSubscriberDiv()});e.bind("click",function(){loginRelated.checkAndLogin(btnStatusSet.getUserPhone)});b.bind("keyup",function(){b.attr("data-val",b.val());btnStatusSet.checkPhoneNumber()});$("#storeSubBtn").bind("click",function(){loginRelated.checkAndLogin(btnStatusSet.storeSubscriberFun)})}else{if(d.is(":visible")){return}else{d.show()}}}},storeSubscriberFun:function(){if(!btnStatusSet.checkPhoneNumber()){return false}var b=$("#subscriberPhone").attr("data-val");var a=URLPrefix.detailDomainAjax+"/ajaxStoreSubscriber.do?phoneNo="+b;var c={"params.skuId":detailParams.skuId,"params.area":cookieUtil.getYhdAreasCookie()};$.ajax({type:"post",url:a,dataType:"jsonp",data:c,jsonp:"callback",success:function(d){var f=d.data;
if(f&&f.rtnData&&d.code==0){var e=f.rtnMsg?f.rtnMsg:"订阅成功";if(f.rtnCode==1){detailSku.followProduct.followRender()}popupUtil.successPopup(e);$("#subscriberDiv").hide();$("#mask").hide()}else{var e=f&&f.rtnMsg?f.rtnMsg:"订阅失败";yhdLib.alert(e)}},error:function(){console.log("ajaxStoreSubscriber error")}})},getUserPhone:function(){loginRelated.getUserNotifyPhone(function(a){if(a){$("#subscriberPhone").val((""+a).replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"));$("#subscriberPhone").attr("data-val",a)}btnStatusSet.checkPhoneNumber();$("#mask").show();$("#subscriberDiv").show()})},hideSubscriberDiv:function(){$("#subscriberDiv").hide();$("#mask").hide();$("#subscriberPhone").val("");$("#subscriberPhone").attr("data-val","")},checkPhoneNumber:function(){var b=$("#subscriberPhone");var a=$("#storeSubBtn");
var c=$("#inputWarn");if(validUtil.isPhoneStr(b.attr("data-val"))){b.css("border-color","green");c.hide();a.attr("disabled",false);return true}else{a.attr("disabled",true);c.show();b.css("border-color","red");return false}}};var detailProdPicture={init:function(){detailProdPicture.initPic();detailProdPicture.initZoomAndSliderEffect();if(detailParams.mainVideo&&detailParams.mainVideo.playUrl){$("#video-player_html5_api").attr("src",detailParams.mainVideo.playUrl);detailProdPicture.playVideo()}},initPic:function(){var c=$("#sub115115PicURL").val();var d=YhdImgUtil.getYhdImgUrlByPath(detailParams.skuId,115,115,c,0);$("#sub115115PicURL").val(d);var b=$("#sub120120PicURL").val();d=YhdImgUtil.getYhdImgUrlByPath(detailParams.skuId,120,120,b,0);$("#sub120120PicURL").val(d);var e=$("#J_prodImg").attr("original_src");d=YhdImgUtil.getYhdImgUrlByPath(detailParams.skuId,360,360,e,0);$("#J_prodImg").attr("src",d);var a=$("#sub600600PicURL").attr("original_src");d=YhdImgUtil.getYhdImgUrlByPath(detailParams.skuId,600,600,a,0);
$("#sub600600PicURL").attr("src",d);$(".detail_main_pic_class").each(function(){var f=$(this).attr("original_src");var g=YhdImgUtil.getYhdImgUrlByPath(detailParams.skuId,50,50,f,0);$(this).attr("src",g)})},initZoomAndSliderEffect:function(){var s=$("#jsModDetailPreview"),r=s.find(".mask"),j=s.find(".proImg"),b=s.find(".zoomCursor"),q=s.find(".J_zoom");s.delegate(".mask","mouseenter",function(){b.show();q.show()});s.delegate(".mask","mouseleave",function(){b.hide();q.hide()});s.delegate(".mask","mousemove",function(E){var n=E||window.Event,G=s.find(".J_zoom img"),F=n.clientX-j.offset().left-b.width()/2,D=n.pageY-j.offset().top-b.height()/2;if(F<0){F=0}else{if(F>r.width()-b.width()){F=r.width()-b.width()}}if(D<0){D=0}else{if(D>r.height()-b.height()){D=r.height()-b.height()}}b.css("left",F);b.css("top",D);
var A=F/(r.width()-b.width()),z=D/(r.height()-b.height()),C=-A*(G.width()-q.width()),B=-z*(G.height()-q.height());G.css("left",C);G.css("top",B)});var m=s.find("#jsproCrumb .prev"),o=s.find("#jsproCrumb .next"),e=s.find("#jsproCrumb .hideBox").width(),d=s.find("#jsproCrumb .hideBox").height(),x=s.find("#jsproCrumb .mBox"),v=s.find("#jsproCrumb .mBox b"),w=s.find("#jsproCrumb .mBox b").outerWidth(true),f=s.find("#jsproCrumb .mBox b").outerHeight(true),i=v.length*v.outerWidth(true),u=v.length*v.outerHeight(true),h=$("#J_zoom"),k=$("#J_prodImg"),p=0,c=0,l=0,t;if(s.parents().hasClass("fashionStore")){x.height(u);function g(){l=p*f;l=Math.min(l,u-d);x.stop().animate({top:-l},500)}if(v.length>d/f){o.click(function(){if(p<v.length-d/f){p+=d/f;g()}});m.click(function(){if(p>0){p-=d/f;g()}})}else{m.hide();
o.hide()}}else{function a(){c=p*w;c=Math.min(c,i-e);x.stop().animate({left:-c},500)}if(v.length>e/w){o.click(function(){if(p<v.length-e/w){p+=e/w;a()}});m.click(function(){if(p>0){p-=e/w;a()}})}else{m.hide();o.hide()}}v.hover(function(D){D.preventDefault();if(!$(this).hasClass("cur")){var n="/s600x600_";var y="/s360x360_";var B=$(this).find("img").attr("src");var A=B.replace(/s\d+x\d+_/,n);var C='<img src="'+A+'" />';h.empty().html(C);t=h.find("img");var z=B.replace(/s\d+x\d+_/,y);k.attr("src",z);$(this).addClass("cur").siblings(".cur").removeClass("cur")}},function(){});v.eq(0).addClass("cur")},playVideo:function(){var hidenBox=$(".hideBox");var J_prodImg=$("#J_prodImg");var shidai=$(".yjsd");function listenHoverImg(){hidenBox.hover(function(){J_prodImg.addClass("j_img_heigh_z");if(shidai){shidai.css("z-index",7)
}},function(){J_prodImg.removeClass("j_img_heigh_z");if(shidai){shidai.css("z-index",1)}})}function removelitenIng(){hidenBox.unbind("mouseenter").unbind("mouseleave")}var Vobj={videoBox:document.getElementById("video-box"),videoContainer:document.getElementById("v-video"),vdomContain:document.getElementById("J-v-player"),videoDom:document.getElementById("video-player_html5_api"),vCenterBtn:document.querySelector(".vjs-big-play-button"),vControlsCon:document.querySelector(".video-controls-container"),vSwitch:document.querySelector(".video-switch"),currentTime:document.getElementById("video-currentTime"),fullScreen:document.getElementById("video-fullScreen"),processLine:document.querySelector(".video-progress-line"),vDuration:document.getElementById("video-duration"),progressPercent:document.querySelector(".video-progress-percent"),progressTimeText:document.querySelector(".video-progress-time"),pointLine:document.querySelector(".video-point-line"),pointTime:document.querySelector(".video-point-time"),bufferedPercent:document.querySelector(".video-buffered-percent"),vCloseBtn:document.querySelector(".v-close-btn"),videoShowBtn:document.querySelector(".video-show-btn"),vVoiceMax:document.querySelector(".video-voice-max"),vVoiceProgress:document.querySelector(".video-voice-progress"),vVoiceImg:document.getElementById("video-voice"),jZoom:document.querySelector(".J_zoom"),zp:document.querySelector(".zoomCursor"),singleVideo:document.getElementById("single-video"),voice:1,proMouseDown:false,voiceMoseDown:false,init:function(){this.vdomContain.addEventListener("click",this.switchHandle.bind(this),false);
this.vdomContain.addEventListener("mouseenter",this.mouseenterHandle.bind(this),false);this.vdomContain.addEventListener("mouseout",this.mouseoutHandle.bind(this),false);this.vControlsCon.addEventListener("mouseover",this.mouseenterHandle.bind(this),true);this.vControlsCon.addEventListener("mouseout",this.mouseoutHandle.bind(this),true);this.vSwitch.addEventListener("click",this.switchHandle.bind(this),false);this.vCenterBtn.addEventListener("click",this.switchHandle.bind(this),true);this.vCenterBtn.addEventListener("mouseenter",this.mouseenterHandle.bind(this),true);this.vCenterBtn.addEventListener("mouseout",this.mouseoutHandle.bind(this),true);this.fullScreen.addEventListener("click",this.toggleFullScreen.bind(this),false);this.processLine.addEventListener("mouseenter",this.initProcess.bind(this),false);
this.processLine.addEventListener("mousemove",this.moveOverPlayTime.bind(this),false);this.processLine.addEventListener("mouseout",this.hiddenPointLine.bind(this),false);this.processLine.addEventListener("mousedown",this.selectPlayTime.bind(this),false);this.processLine.addEventListener("mouseup",this.relaseMouse.bind(this),false);this.vCloseBtn.addEventListener("click",this.closeVideo.bind(this),false);this.videoShowBtn.addEventListener("click",this.showVideo.bind(this),false);this.videoShowBtn.addEventListener("mouseenter",this.showMark.bind(this),false);this.vVoiceMax.addEventListener("mouseenter",this.initVoiceLinew.bind(this),false);this.vVoiceMax.addEventListener("mousemove",this.voiceMove.bind(this),false);this.vVoiceMax.addEventListener("mousedown",this.setVoiceMousedown.bind(this),false);
this.vVoiceMax.addEventListener("mouseup",this.setVoiceMouseup.bind(this),false);this.vVoiceImg.addEventListener("click",this.vVoiceSwitch.bind(this),false);this.lisetenScreenChange();this.getBaseData();this.getBuffered();var _this=this;if(navigator.appName=="Microsoft Internet Explorer"){document.addEventListener("keyup",function(event){if(event.keyCode==27&&_this.isFullscreen()){_this.exitFullscreen()}},false)}if(navigator.userAgent.indexOf("Firefox")>=0){setTimeout(function(){if(_this.videoDom.error&&_this.videoDom.error.code==3){clearTimeout(_this.firefoxTimer);_this.videoContainer.style.display="none";_this.videoShowBtn.style.display="none";console.log("视频解码失败");return}else{$("#video-box").show()}},1000)}else{$("#video-box").show()}if(this.singleVideo){this.singleVideo.style.position="relative";
this.videoShowBtn.style.bottom="45px"}},prdRequeset:function(){this.showVideo();this.vVoiceSwitch()},switchHandle:function(){if(this.videoDom.paused){this.palyStus()}else{this.stopStus()}},mouseenterHandle:function(){if(this.videoDom.paused){this.vCenterBtn.style.backgroundColor="#cc181e"}return},mouseoutHandle:function(){if(this.videoDom.paused){this.vCenterBtn.style.backgroundColor="rgba(0,0,0,0.5)"}return},palyStus:function(){this.vCenterBtn.style.display="none";this.vSwitch.className="video-hover-shadow video-stop-switch";this.vControlsCon.className="video-controls-container";if(navigator.userAgent.indexOf("Firefox")>=0){if(this.videoDom.error&&this.videoDom.error.code==3){clearTimeout(this.firefoxTimer);this.videoContainer.style.display="none";this.videoShowBtn.style.display="none";console.log("视频解码失败");
return}if(!this.videoDom.duration){this.videoDom.load();var _this=this;this.firefoxTimer=setTimeout(function(){_this.palyStus()},300)}else{clearTimeout(this.firefoxTimer);this.videoBox.style.display="block";this.videoDom.play()}}else{this.videoBox.style.display="block";this.videoDom.play()}this.getCurrentTime()},stopStus:function(){this.vCenterBtn.style.display="block";this.vSwitch.className="video-switch video-hover-shadow";this.vControlsCon.className="video-controls-container v-stopstus";this.videoDom.pause();clearTimeout(this.timer)},getCurrentTime:function(){var _this=this;this.timer=setTimeout(function(){_this.setCurrentTime();if(_this.videoDom.ended){J_prodImg.removeClass("j_img_heigh_z");if(shidai){shidai.css("z-index",1)}_this.resetData();clearTimeout(_this.timer);return}_this.getCurrentTime()
},50)},resetData:function(){this.exitFullscreen();this.closeVideo()},setCurrentTime:function(){var cuTime=this.videoDom.currentTime;var pasTime=this.formatTime(cuTime);this.getBaseData();var currentPosition=this.maxTimeWidth*(cuTime/this.duration);this.setProgressPercent(currentPosition,pasTime)},formatTime:function(time){time=time?time:0;time=parseInt(time);var newTime=void 0;if(time<10){newTime="0:0"+time}else{if(time<60){newTime="0:"+time}else{if(time%60<10){newTime=parseInt(time/60)+":0"+time%60}else{newTime=parseInt(time/60)+":"+time%60}}}return newTime},setProgressPercent:function(currentPosition,pasTime){this.progressPercent.style.width=currentPosition+"px";this.progressTimeText.innerHTML=pasTime;this.currentTime.innerHTML=pasTime},getBaseData:function(){this.conOffset=this.videoContainer.getBoundingClientRect().left;
this.maxTimeWidth=this.processLine.clientWidth;this.duration=this.videoDom.duration},toggleFullScreen:function(){if(this.isFullscreen()){this.exitFullscreen()}else{this.launchFullScreen()}},isFullscreen:function(){if(this.videoContainer.className.indexOf("all-screen")!=-1){return true}else{return false}},launchFullScreen:function(){$("#J_fixedDes").css("z-index",0);$(".proImg").css("z-index",99999999);$("html").css({height:"100%",overflow:"hidden"});this.fullScreen.className="video-allscreen video-hover-shadow close-allscreen";this.videoContainer.className="j-video all-screen";var el=document.documentElement;if(el.requestFullScreen){el.requestFullScreen()}else{if(el.mozRequestFullScreen){el.mozRequestFullScreen()}else{if(el.webkitRequestFullScreen){el.webkitRequestFullScreen()}else{if(el.msRequestFullScreen){el.msRequestFullScreen()
}}}}},exitFullscreen:function(){$("#J_fixedDes").css("z-index",9999);$(".proImg").css("z-index",99);$("html").css({height:"auto",overflow:"auto"});this.fullScreen.className="video-allscreen video-hover-shadow";this.videoContainer.className="j-video";var el=document;if(el.exitFullscreen){el.exitFullscreen()}else{if(el.mozCancelFullScreen){el.mozCancelFullScreen()}else{if(el.webkitCancelFullScreen){el.webkitCancelFullScreen()}else{if(el.msCancelFullScreen){el.msCancelFullScreen()}}}}},lisetenScreenChange:function(){var _this2=this;var el=document.documentElement;var handleScreenChange=function handleScreenChange(plant){document.addEventListener(plant+"fullscreenchange",function(){_this2.getBaseData();if(plant=="moz"){var screenState="document."+plant+"FullScreenElement"}else{var screenState="document."+plant+"FullscreenElement"
}if(eval(screenState)!=null){_this2.launchFullScreen()}else{_this2.exitFullscreen()}})};if(el.webkitRequestFullScreen){handleScreenChange("webkit")}else{if(el.mozRequestFullScreen){handleScreenChange("moz")}else{if(el.msRequestFullScreen){handleScreenChange("ms")}else{if(el.requestFullScreen){handleScreenChange("")}}}}},moveOverPlayTime:function(event){this.getBaseData();this.pointEl=event.clientX-this.conOffset;this.selectHoverTime=this.pointEl/this.maxTimeWidth*this.duration;this.selectTime=this.formatTime(this.selectHoverTime);this.pointLine.style.display="block";this.pointLine.style.left=this.pointEl+"px";this.pointTime.innerHTML=this.selectTime;if(this.proMouseDown){this.selectPlayTime()}},initProcess:function(){this.proMouseDown=false},hiddenPointLine:function(){this.pointLine.style.display="none"
},selectPlayTime:function(){this.proMouseDown=true;this.setProgressPercent(this.pointEl,this.selectTime);this.videoDom.currentTime=this.selectHoverTime;return false},relaseMouse:function(){this.proMouseDown=false},getBuffered:function(){var _this3=this;this.bufferTimer=setTimeout(function(){if(!_this3.videoDom.duration||!_this3.videoDom.buffered){_this3.getBuffered();return}_this3.setDurationTime(_this3.videoDom.duration);var buffered=_this3.videoDom.buffered.end(0);_this3.bufferedPercent.style.width=buffered/_this3.videoDom.duration*_this3.maxTimeWidth+"px";if(buffered>=_this3.videoDom.duration){clearTimeout(_this3.bufferTimer);return}_this3.getBuffered()},100)},setDurationTime:function(time){if(this.vDuration.innerHTML!=="0:00"){return}this.vDuration.innerHTML=this.formatTime(time)},showVideo:function(){this.videoContainer.style.display="block";
this.palyStus();if(this.jZoom){this.zp.style.display="none";this.jZoom.style.display="none"}listenHoverImg()},showMark:function(){if(this.jZoom){this.zp.style.display="block";this.jZoom.style.display="block"}},closeVideo:function(){this.exitFullscreen();this.videoContainer.style.display="none";this.stopStus();clearTimeout(this.bufferTimer);removelitenIng()},setVoice:function(event){var voiceReactLeft=this.vVoiceMax.getBoundingClientRect().left;var maxWidth=this.vVoiceMax.clientWidth;var voicePosition=event.clientX-voiceReactLeft;if(navigator.userAgent.indexOf("Firefox")>=0){voicePosition=voicePosition>0?voicePosition:0}else{voicePosition=Math.abs(voicePosition)}this.voice=voicePosition/maxWidth;if(this.voice<0.03){this.voice=0;this.vVoiceProgress.style.width="0px"}else{if(this.voice>0.97){this.voice=1;
this.vVoiceProgress.style.width="100%";this.vVoiceProgress.style.display="block"}else{this.vVoiceProgress.style.width=voicePosition+"px";this.vVoiceProgress.style.display="block"}}this.videoDom.volume=this.voice;this.setVoiceImg()},initVoiceLinew:function(){this.voiceMoseDown=false},voiceMove:function(event){if(this.voiceMoseDown){this.setVoice(event)}},setVoiceMousedown:function(event){this.voiceMoseDown=true;this.setVoice(event)},setVoiceMouseup:function(){this.voiceMoseDown=false},vVoiceSwitch:function(){var vDomvoice=this.videoDom.volume;if(vDomvoice>0){this.vVoiceProgress.style.display="none";this.vVoiceImg.className="video-voice-close video-hover-shadow";this.videoDom.volume=0}else{this.vVoiceProgress.style.display="block";this.videoDom.volume=this.voice;this.setVoiceImg()}},setVoiceImg:function(){if(this.voice<0.3){this.vVoiceImg.className="video-voice-small video-hover-shadow"
}else{if(this.voice<0.7){this.vVoiceImg.className="video-voice-middle video-hover-shadow"}else{this.vVoiceImg.className="video-voice-large video-hover-shadow"}}}};if(!!window.ActiveXObject||"ActiveXObject" in window){var browser=navigator.appName;var b_version=navigator.appVersion;var version=b_version.split(";");var trim_Version=version[1].replace(/[ ]/g,"");if((browser=="Microsoft Internet Explorer"&&trim_Version=="MSIE6.0")||(browser=="Microsoft Internet Explorer"&&trim_Version=="MSIE7.0")||(browser=="Microsoft Internet Explorer"&&trim_Version=="MSIE8.0")){Vobj.videoContainer.style.display="none";Vobj.videoShowBtn.style.display="none"}else{if(browser=="Microsoft Internet Explorer"&&trim_Version=="MSIE9.0"){ie9()}else{Vobj.videoShowBtn.style.display="block";Vobj.init()}}}else{Vobj.videoShowBtn.style.display="block";
Vobj.init()}function ie9(){Vobj.ie9timer=setTimeout(function(){console.log("width: "+Vobj.videoDom.videoWidth+", height: "+Vobj.videoDom.videoHeight);if(Vobj.videoDom.videoWidth>1280){Vobj.videoContainer.style.display="none";Vobj.videoShowBtn.style.display="none";console.log("视频尺寸不正确，width: "+Vobj.videoDom.videoWidth+", height: "+Vobj.videoDom.videoHeight);clearTimeout(Vobj.ie9timer);return}else{if(Vobj.videoDom.videoWidth>100&&Vobj.videoDom.videoWidth<=1280){Vobj.videoShowBtn.style.display="block";Vobj.init();console.log("视频尺寸正确，width: "+Vobj.videoDom.videoWidth+", height: "+Vobj.videoDom.videoHeight);clearTimeout(Vobj.ie9timer);return}}ie9()},100)}}};var areasSelectBox={defaultArea:"2_2817_51973_0",init:function(d){var c=cookieUtil.getYhdAreasCookie();if(!c||c.split("_").length!=4){cookieUtil.setYhdAreasCookie(areasSelectBox.defaultArea);d();areasSelectBox.initArea()}else{var b=c.split("_")[0];var a=c.split("_")[3];if(a==0&&b!=1&&b!=2&&b!=3&&b!=4){areasSelectBox.checkAreaCookie(c,function(){d();areasSelectBox.initArea()})}else{d();areasSelectBox.initArea()}}},initArea:function(){areasSelectBox.selectJs(".addressbox");areasSelectBox.openSelect()},checkAreaCookie:function(d,f){var c=d.split("_")[0];var e=d.split("_")[1];var a=d.split("_")[2];var b=URLPrefix.detailDomain+"/squ/item/ajaxCheckAreaCookie.do?countyId="+a;$.ajax({url:b,cache:3000,type:"GET",success:function(g){if(g&&g.data){var h=g.data;if(h!=0){cookieUtil.setYhdAreasCookie(c+"_"+e+"_"+a+"_"+h)
}f()}else{f()}},error:function(){f()}})},op:"",oc:"",ocounty:"",ot:"",selectJs:function(f){var a=$(f);var c=a.find(".tablist li");var h=a.find(".sec_level");var j=h.find(".sec_item");var g=a.find(".input_btn");var b=g.find(".value");var k=a.find(".selectclose");function e(){c.bind("click",function(){var l=$(this).index();$(this).addClass("cur").siblings().removeClass("cur");$(this).parents(".mod_selectbox").find(".sec_level").eq(l).show().siblings().hide()}).eq(0).trigger("click")}function d(){j.bind("click",function(){var o=$(this).parents(".sec_level");var m=o.index();var n=$(this).text();var l=$(this).attr("data-id");o.find(".sec_item").removeClass("cur");$(this).addClass("cur");op=c.eq(0).html();oc=c.eq(1).html();ocounty=c.eq(2).html();ot=c.eq(3).html();if(m==0){op=$(this).text();c.eq(m).attr("data-id",l);
c.eq(m).html(n+"<i></i>");areasSelectBox.initCityData(l)}})}function i(){var l=a.find(".selectlist");g.bind("click",function(m){m.preventDefault();areasSelectBox.queryUsualAddressList(function(){a.find(".mod_selectbox").css({"z-index":110});a.find(".selectlist").show()})});k.bind("click",function(){$(this).parents(".selectlist").hide();a.find(".mod_selectbox").removeAttr("style")});$(document).mousedown(function(m){if($(m.target).parents(".selectlist").length<1){l.hide();a.find(".mod_selectbox").removeAttr("style")}})}i();e();d()},initCityData:function(c,a){var b=URLPrefix.detailDomain+"/squ/item/ajaxGetAreas.do?type=2&parentId="+c;$.ajax({url:b,cache:3000,type:"GET",success:function(d){areasSelectBox.initCityDataCK(d,a)}})},initCityDataCK:function(a,b){var c=this;if(a){if(!b){$("#tabs_city").show();
$("#tabs_city").html("请选择<i></i>");$("#tabs_county").hide();$("#tabs_town").hide();$("#tabs_city").addClass("cur").siblings().removeClass("cur");$(".addressbox").find(".sec_level").eq(1).show().siblings().hide()}$("#mod_address_city").html(a);this.locateTabs(1);$("#mod_address_city .sec_item").unbind("click.e").on("click.e",function(){$("#mod_address_city .sec_item").removeClass("cur");$(this).addClass("cur");var d=$(this).text();var e=$(this).attr("data-id");if(e>0){$("#tabs_city").attr("data-id",e);$("#tabs_city").html(d+"<i></i>");oc=d;c.initCountyData(e);$("#tabs_county").addClass("cur").siblings().removeClass("cur");$(".addressbox").find(".sec_level").eq(2).show().siblings().hide()}})}},initCountyData:function(c,a){var b=URLPrefix.detailDomain+"/squ/item/ajaxGetAreas.do?type=3&parentId="+c;
$.ajax({url:b,cache:3000,type:"GET",success:function(d){areasSelectBox.initCountyDataCK(d,a)}})},initCountyDataCK:function(a,b){var c=this;if(a){if(!b){$("#tabs_county").show();$("#tabs_county").html("请选择<i></i>");$("#tabs_town").hide()}$("#mod_address_county").html(a);this.locateTabs(2);$("#mod_address_county .sec_item").unbind("click.e").on("click.e",function(){$("#mod_address_county .sec_item").removeClass("cur");$(this).addClass("cur");var e=$(this).text();var d=$(this).attr("data-id");if(d>0){$("#tabs_county").attr("data-id",d);$("#tabs_county").html(e+"<i></i>");ocounty=e;c.initTownData(d)}})}},initTownData:function(b,a){var c=URLPrefix.detailDomain+"/squ/item/ajaxGetAreas.do?type=4&parentId="+b;$.ajax({url:c,cache:3000,type:"GET",success:function(d){areasSelectBox.initTownDataCK(d,a)
}})},initTownDataCK:function(a,b){if(a){if(!b){$("#tabs_town").show();$("#tabs_town").html("请选择<i></i>")}$("#mod_address_town").html(a);this.locateTabs(3);$("#tabs_town").addClass("cur").siblings().removeClass("cur");$(".addressbox").find(".sec_level").eq(3).show().siblings().hide();$("#mod_address_town .sec_item").unbind("click.e").on("click.e",function(){$("#mod_address_town .sec_item").removeClass("cur");$(this).addClass("cur");var d=$(this).text();var c=$(this).attr("data-id");if(c>0){$("#tabs_town").attr("data-id",c);$("#tabs_town").html(d+"<i></i>");$(this).parents(".selectlist").hide();ot=$(this).text();$(".addressbox").find(".mod_selectbox").addClass("sel");areasSelectBox.set4AreaAndUpdateGlobalCookie()}})}else{$(".selectlist").hide();$("#tabs_town").attr("data-id",0);if(!b){areasSelectBox.set4AreaAndUpdateGlobalCookie()
}}},openSelect:function(){areasSelectBox.initFourthAreaInfo()},initFourthAreaInfo:function(){var h=this;var c=cookieUtil.getYhdAreasCookie().split("_");var f=c[0];var g=c[1];var a=c[2];var e=c[3];$("#tabs_province").attr("data-id",f);$("#tabs_city").attr("data-id",g);$("#tabs_county").attr("data-id",a);var b;if(e>0){$("#tabs_town").attr("data-id",e);$("#tabs_town").addClass("cur").siblings().removeClass("cur");b=3}else{$("#tabs_county").addClass("cur").siblings().removeClass("cur");$("#tabs_town").hide();b=2}h.initCityData(f,1);h.initCountyData(g,1);h.initTownData(a,1);h.locateTabs(0);$(".addressbox").find(".sec_level").eq(b).show().siblings().hide();var d=cookieUtil.getYhdUsualAddressIdByCookie();if(d!=null&&d!=""&&d!=undefined){areasSelectBox.findUsualAddress(d[0],function(i){areasSelectBox.initShowInputBtnArea(h,e,i)
})}else{areasSelectBox.findUsualAddress(null,function(i){areasSelectBox.initShowInputBtnArea(h,e,i)})}},initShowInputBtnArea:function(d,c,a){var b=URLPrefix.detailDomain+"/squ/item/ajaxGetFourthAreaName.do?fourthAreaId="+cookieUtil.getYhdAreasCookie();$.ajax({url:b,cache:3000,type:"GET",success:function(e){if(e&&e.data){var l=e.data;var i=l.split("_");var f=i[0];var g=i[1];var h=i[2];var k=i[3]==0?"":i[3];var j=f+g+h+k;if(a!=null){areasSelectBox.selectListShowAddress(a.fullAddress)}else{areasSelectBox.selectListShowAddress(j)}d.op=f;d.oc=g;d.ocounty=h;d.ot=k;$("#tabs_province").html(f);$("#tabs_city").html(g);$("#tabs_county").html(h);if(c>0){$("#tabs_town").html(k)}}}})},set4AreaAndUpdateGlobalCookie:function(){var b=this;var d=$("#tabs_province").attr("data-id");var c=$("#tabs_city").attr("data-id");
var k=$("#tabs_county").attr("data-id");var a=$("#tabs_town").attr("data-id");var f=$("#tabs_province").html();var h=$("#tabs_city").html();var i=$("#tabs_county").html();var g=$("#tabs_town").html();if(a==0){g=0}b.op=f;b.oc=h;b.ocounty=i;b.ot=g?g:"";var e=f+h+i+b.ot;areasSelectBox.selectListShowAddress(e);var j=d+"_"+c+"_"+k+"_"+a;cookieUtil.setYhdAreasCookie(j);window.location.reload()},locateTabs:function(f){var b=$(".addressbox").find(".sec_level").eq(f);if(f==0){var d=$("#tabs_province").attr("data-id");b.find(".sec_item").removeClass("cur");b.find(".sec_item").each(function(){if($(this).attr("data-id")==d){$(this).addClass("cur");return}})}else{if(f==1){var e=$("#tabs_city").attr("data-id");b.find(".sec_item").removeClass("cur");b.find(".sec_item").each(function(){if($(this).attr("data-id")==e){$(this).addClass("cur");
return}})}else{if(f==2){var a=$("#tabs_county").attr("data-id");b.find(".sec_item").removeClass("cur");b.find(".sec_item").each(function(){if($(this).attr("data-id")==a){$(this).addClass("cur");return}})}else{if(f==3){var c=$("#tabs_town").attr("data-id");b.find(".sec_item").removeClass("cur");b.find(".sec_item").each(function(){if($(this).attr("data-id")==c){$(this).addClass("cur");return}})}}}}},moreUsulAddress:function(){$(".selectlist_name").show();$(".common_address").show();var a=$(".selectlist .common_address .more_then_two");var b=$(".selectlist .common_address .more_btn");b.on("click",function(){$(this).hide();a.slideToggle()})},queryUsualAddressList:function(b){var a=URLPrefix.detailDomainAjax+"/ajaxGetUsualAdressList.do";$.ajax({type:"get",url:a,timeout:6000,dataType:"jsonp",jsonp:"callback",success:function(d){if(d&&d.code==1&&d.data){var c=d.data;
if(c==null||c.length==0){b();return}areasSelectBox.sortAddressList(c,function(j,k){var h=$(".selectlist .common_address");var f="";if(j==null||j==""||j==undefined){b();return}for(var g=0;g<j.length;g++){if(j[g]==null||j[g]==""||j[g]==undefined){return}var e=j[g];if(g>=2){f+='<div class="more_then_two hide">'}if(g==0&&k){f+='<li class="address_option cur clearfix" onclick="areasSelectBox.selectedUsualAddress('+e.id+')"><div class="iconfont">&#xe627;</div>'}else{f+='<li class="address_option clearfix" onclick="areasSelectBox.selectedUsualAddress('+e.id+')"><div class="iconfont">&#xe627;</div>'}f+='<div class="address_name">'+e.name+"</div>";f+='<div class="address_detail">'+e.fullAddress+"</div>";f+="</li>";if(g>=2){f+="</div>"}}f+='<div class="more_btn">更多<i class="iconfont">&#xe606;</i></div>';
h.html(f);areasSelectBox.moreUsulAddress()})}b()}})},sortAddressList:function(f,h){var b=cookieUtil.getYhdUsualAddressIdByCookie();if(b==null||b==""||b==undefined){h(f,false);return}if(f==null){h(f,false);return}var a=true;for(var e=0;e<f.length;e++){if(f[e].id==b[0]){a=false;if(f[e].gcLng!=b[1]||f[e].gcLat!=b[2]){cookieUtil.setCookie(detail_yhdUsualAddress_cookie,"");h(f,false);return}break}}if(a){cookieUtil.setCookie(detail_yhdUsualAddress_cookie,"");h(f,false);return}var c=f[0];var d=b[0];var g;if(c.id==d){h(f,true);return}for(var e=0;e<f.length;e++){if(f[e].id==d){g=f[e];f[e]=c;f[0]=g;break}}h(f,true);return},selectedUsualAddress:function(a){areasSelectBox.findUsualAddress(a,areasSelectBox.reloadPageForUsualAddress)},findUsualAddress:function(a,d){if(a==null){d(null);return}var b=URLPrefix.detailDomainAjax+"/ajaxUsualAdressById.do";
var c={addressId:a};$.ajax({type:"get",url:b,timeout:6000,data:c,dataType:"jsonp",jsonp:"callback",success:function(e){if(e&&e.code==1&&e.data){var f=e.data;cookieUtil.setYhdUsualAddressCookie(f);d(e.data);return}d(null);return}})},reloadPageForUsualAddress:function(a){if(a!=null&&a.fullAddress!=null){areasSelectBox.selectListShowAddress(a.fullAddress);window.location.reload()}else{areasSelectBox.set4AreaAndUpdateGlobalCookie()}},selectListShowAddress:function(a){if(a!=null&&a!=""&&a!=undefined){var c=$(".addressbox").find(".input_btn").find(".value");var b;if(a.length>15){b=a.substring(0,14)+"...";c.html(b)}else{c.html(a)}c.attr("title",a)}}};var detailSku={mobileKo:{},panicnNoGoods:1,showPrice:function(d,a){var c={"params.area":cookieUtil.getYhdAreasCookie(),"params.skuIds":detailParams.skuId};var b=URLPrefix.detailDomainAjax+"/getPrices.do";$.ajax({type:"get",url:b,dataType:"jsonp",data:c,jsonp:"callback",success:function(e){if(e&&e.data&&e.data.length>0){var g=e.data;var f=g[0].p;if(f&&f>0){d(g[0])}else{if(typeof a=="function"){a()}}}else{if(typeof a=="function"){a()}}},error:function(){if(typeof a=="function"){a()}}})},getCurShowPrice:function(){var a=$("#current_price").html();if(a){return a.replace("¥","")}},errPriceCallback:function(){},priceCommCallback:function(c){var b=c.p;var a=c.type;if(a==1){$("#current_price").css("font-size","20px").html("¥"+c.msg)}else{$("#current_price").html("¥"+b);var d=$("#J_fixedDes");d.find(".tab_buy_info .tab_price").html("<em>¥</em>"+b);
if(detailParams.isBookVideo&&!detailParams.isPop){if(c&&c.p&&c.m){var f=Math.ceil(c.p/c.m*100)/10;if(f>0){var e="<li class='price_discount'>["+f+"折]&nbsp;&nbsp;</li>[定价：<del>¥"+c.m+"</del>]";$("#bookprice").html(e)}}}}detailSku.priceNotice()},getStockAndPrice:function(d){var b=0;if(detailParams.spAttr&&detailParams.spAttr.fqsp){if(detailParams.spAttr.fqsp=="1"||detailParams.spAttr.fqsp=="2"){b=detailParams.spAttr.fqsp}}var c={skuId:detailParams.skuId,area:cookieUtil.getYhdAreasCookie(),cat:detailParams.categoryIds.join(","),buyNum:1,venderId:detailParams.venderId,fqsp:b,coord:d};var a=URLPrefix.jd_item_stock;$.ajax({url:a,type:"get",dataType:"jsonp",data:c,scriptCharset:"gbk",jsonp:"callback",success:function(f){if(f&&f.stock){var g=f.stock;var e=g.realSkuId;if(e&&e!=detailParams.skuId){location.href=URLPrefix.detailDomain+"/"+e+".html"
}else{btnStatusSet.checkMobileKo(function(){detailSku.handleLowBuyAndAmountBox();detailSku.setBtnAndPriceFun(g)})}}},error:function(f){console.log("load stock error")}})},getStockAndPriceCheckLogin:function(){var b="";var a=cookieUtil.getYhdUsualAddressIdByCookie();if(a==null||a==""||a==undefined){detailSku.getStockAndPrice(b);return}loli.globalCheckLogin(function(c){if(c&&c.result==1){areasSelectBox.findUsualAddress(a[0],function(d){if(d!=null&&d!=""&&d!=undefined){b=d.gcLng+","+d.gcLat;areasSelectBox.selectListShowAddress(d.fullAddress);detailSku.getStockAndPrice(b)}else{detailSku.getStockAndPrice(b)}})}else{detailSku.getStockAndPrice(b)}})},setBtnAndPriceFun:function(e){var c=btnStatusSet.getbtnStatus(e,true);var a=btnStatusSet.getbtnStatus(e,false);var d=btnStatusSet.getOneKeyGoBtnStatus(e);
var b=a==3;detailSku.handleTransferInfo(e,c,b);if(a==2||a==3){if(c==1){detailSku.panicnNoGoods=-1}btnStatusSet.setSpecilAddCartButton(a,function(){detailSku.errCallback(c,d)});return}detailSku.commonCallback(c);btnStatusSet.setOneKeyGoBtn(d);btnStatusSet.setStoreNotifyBtn(a,e)},errCallback:function(a,b){detailSku.commonCallback(a);btnStatusSet.setOneKeyGoBtn(b)},commonCallback:function(a){detailSku.showPrice(detailSku.priceCommCallback,detailSku.errPriceCallback);btnStatusSet.setAddCartButton(a)},addCartEvent:function(){detailSku.resetBtnStauts();$("#addCart").show();$("#addCart").attr("btn_init_flag","1");$("#addCart").unbind();jQuery("#detail_desc_addCartBtn_fixed").show();jQuery("#detail_desc_addCartBtn_fixed").unbind();require(["common_cart"],function(b){$("#addCart, #detail_desc_addCartBtn_fixed").bind("click",function(){var c={pid:detailParams.skuId,ptype:"1",pcount:$("#product_amount").val(),sku:"",did:"",zids:"",gids:""};
b.addToCart(c);log("AddToCartYhd","ProductYhd",detailParams.skuId)})});var a=$("#J_fixedDes");a.delegate(".des_buy","mouseenter mouseleave",function(){if(!$(this).hasClass("hover")){if($("#J_fixedDes").find("img").attr("src")==""){var b=$("#J_prodImg").attr("original_src");var c=YhdImgUtil.getYhdImgUrlByPath(detailParams.skuId,115,115,b,0);$("#J_fixedDes").find("img").attr("src",c)}}$(this).toggleClass("hover")})},handleLowBuyAndAmountBox:function(){var b=detailParams.spAttr;var a=1;if(b&&b.LowestBuy&&numberUtil.isInt(b.LowestBuy)){a=b.LowestBuy}detailSku.handleProductAmountBox(a)},handleTransferInfo:function(a,b,p){var m=detailParams.isPop;var g=a.stockDesc;var o=p?"":a.promiseResult;var c=a.dcashDesc;detailSku.handlePayServiceList(a);if(b!=1){if(m){if(c&&c!=""){c=c.replace(/<.*?>/ig,"");$("#detailStockInfo").html(g+"，&nbsp;&nbsp;"+c);
var u=g+"，"+c;u=u.replace(/<.*?>/ig,"");$("#detailStockInfo").attr("title",u)}else{$("#detailStockInfo").html(g);$("#detailStockInfo").attr("title",g.replace(/<.*?>/ig,""))}}else{if(o&&o!=""){o=o.replace(/京东物流/ig,"1号店");$("#detailStockInfo").html(g+"，&nbsp;&nbsp;"+o);var u=g+"，"+o;u=u.replace(/<.*?>/ig,"");$("#detailStockInfo").attr("title",u)}else{$("#detailStockInfo").html(g);$("#detailStockInfo").attr("title",g.replace(/<.*?>/ig,""))}}}else{$("#detailStockInfo").html("<strong>无货</strong>")}var h=a.serviceInfo;if(h){if(!m){if("true"===a.isSupportAfs||(a.self_D&&"true"===a.self_D.po)){h="由&nbsp;1号店&nbsp;发货，并提供售后服务"}else{h=h.replace(/<.*?>/ig,"&nbsp;").replace("京东","1号店")}}else{h=h.replace(/<.*?>/ig,"&nbsp;").replace("京东","1号店");if(o&&o!=""){o=o.replace(/京东物流/ig,"1号店");h=h+o+"&nbsp;&nbsp;&nbsp;"
}}}else{h=""}var j=a.ir;var e=a.eir;var k="";if(m){if(e&&e.length>0){for(var q=0;q<e.length;q++){if(e[q].iconCode=="free_delivery_zhong"||e[q].iconCode=="free_delivery_fresh_zhong"){k+='&nbsp;&nbsp;<span class="link" title="'+e[q].iconTip+'">'+e[q].showName+"</span>"}}}}var s="";var d="";var l="";var t="";var n="";if(e&&e.length>0){for(var q=0;q<e.length;q++){if(e[q].iconCode=="payment_cod"||e[q].iconCode=="pop_PaymentCod"){s='&nbsp;&nbsp;<a target="_blank" href="//cms.yhd.com/cms/view.do?topicId=25" class="link" title="'+e[q].iconTip+'">'+e[q].showName+"</a>"}}}if(j&&j.length>0){for(var q=0;q<j.length;q++){if(j[q].iconCode=="sendpay_zhun"){d='&nbsp;&nbsp;<a target="_blank" href="//cms.yhd.com/cms/view.do?topicId=23" class="link" title="准时达">准时达</a>'}if(j[q].iconCode=="sendpay_311"){l='&nbsp;&nbsp;<span class="link" title="'+j[q].iconTip+'">'+j[q].showName+"</span>"
}if(j[q].iconCode=="sendpay_211"){t='&nbsp;&nbsp;<span class="link" title="'+j[q].iconTip+'">'+j[q].showName+"</span>"}if(j[q].iconCode=="sendpay_guangsuda"){n='&nbsp;&nbsp;<span class="link" title="'+j[q].iconTip.substring(0,j[q].iconTip.length-1)+'">'+j[q].showName+"</span>"}}}k+=s+d+l+t+n;if(!m){var r={"params.skuId":detailParams.skuId,"params.popType":0,"params.cat":detailParams.categoryIds.join(","),"params.area":cookieUtil.getYhdAreasCookie(),"param.channelId":0};var f=URLPrefix.detailDomainAjax+"/ajaxGetYHDFreightConfigInfo.do";$.ajax({type:"get",url:f,dataType:"jsonp",data:r,jsonp:"callback",success:function(i){if(i&&i.data){var v=i.data;if(v.showName){var w='&nbsp;&nbsp;&nbsp;<a target="_blank" href="//cms.yhd.com/cms/view.do?topicId=23" class="link" title="'+v.showName+'">'+v.showName+"</a>";
k=w+k}}if(k!=""){k="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;支持"+k}$("#detaiThreeAreas .add_02").html(h+k)},error:function(){if(k!=""){k="支持"+k}$("#detaiThreeAreas .add_02").html(h+k)}})}else{if(k!=""){k="支持"+k}$("#detaiThreeAreas .add_02").html(h+k)}},handlePayServiceList:function(g){var f=detailParams.isPop;var c="";var a=g.promiseYX;var e=g.ir;var d=false;if(a){if(a.iconCode=="service_qitiantuihuo"||a.iconCode=="service_ninetytuihuo"){c+='<a href="javascript:void(0);" style="" title="'+a.iconTip+'"><i class="iconDetail"></i>'+a.iconTip+"</a>";d=true}else{if(a.iconCode=="service_noreturn"){c+='<a id="7dayReturnTag" href="javascript:void(0);" style="" title="'+a.iconTip+'"><i class="iconDetail">&#xe616;</i>'+a.iconTip+"</a>";d=true}}}else{if(e&&e.length>0){for(var b=0;b<e.length;b++){if(e[b].iconCode=="service_30daystuihuo"){c+='<a href="javascript:void(0);" style="" title="'+e[b].iconTip+'"><i class="iconDetail"></i>'+e[b].iconTip+"</a>";
d=true;break}}}}if(!f){c+='<a href="javascript:void(0);" style="" title="正品保障"><i class="iconDetail"></i>正品保障</a>';d=true}if(d){$("#payServiceList").append(c)}else{$("#serviceGuarantee").hide()}},handleOneRobBuyProduct:function(){if(detailParams.productKO){if(detailSku.isReserveBuyProduct()){return}require(["detailOneRobBuy"],function(a){a.init()})}},handleReserveBuyProduct:function(a){if(detailSku.isReserveBuyProduct()){reserveBuy.init(a)}},isReserveBuyProduct:function(){if(detailParams.spAttr&&detailParams.spAttr.isYuYue&&(detailParams.spAttr.isYuYue==1||detailParams.spAttr.isYuYue=="1")){return true}return false},handleProductAmountBox:function(c,b){if(!c||c<=0){c=1}if(detailSku.mobileKo&&detailSku.mobileKo.status){b=1}var a=$("#computing_item");a.find("input.num").attr("data-min",c);a.find("input.num").val(c);
if(b&&b>0){a.find("input.num").attr("data-max",b)}var d=null;a.each(function(){var g=$(this).find("input.num");var f=$(this).find(".computing_act input");var e=g.attr("data-max");var h=parseInt(g.attr("data-min"))||1;g.val(h);f.eq(1).attr("class","no_reduce");f.eq(0).attr("class",e==h?"no_add":"add");g.unbind("input propertychange").bind("input propertychange",function(){var i=this;var j=$(i).val();d&&clearTimeout(d);d=setTimeout(function(){var k=Math.max(Math.min(e,j.replace(/\D/gi,"").replace(/(^0*)/,"")||1),h);$(i).val(k);if(k==h&&e==h){f.eq(0).attr("class","no_add");f.eq(1).attr("class","no_reduce")}else{if(k==e){f.eq(0).attr("class","no_add");f.eq(1).attr("class","reduce")}else{if(k<=h){f.eq(1).attr("class","no_reduce");f.eq(0).attr("class","add")}else{f.eq(1).attr("class","reduce");f.eq(0).attr("class","add")
}}}detailSku.productAmountChange()},50)}).trigger("input propertychange").blur(function(){$(this).trigger("input propertychange")}).keydown(function(j){if(j.keyCode==38||j.keyCode==40){var i=0;j.keyCode==40&&(i=1);f.eq(i).trigger("click")}});f.unbind("click").bind("click",function(j){if(!$(this).hasClass("no_reduce")){var i=parseInt(g.val(),10)||1;if($(this).hasClass("add")&&!$(this).hasClass("no_add")){i++;$(this).next().attr("class","reduce");if(e>h&&i>=e){$(this).attr("class","no_add")}}else{if($(this).hasClass("reduce")&&!$(this).hasClass("no_reduce")){i--;$(this).prev().attr("class","add");i<=h&&$(this).attr("class","no_reduce")}}g.val(i)}detailSku.productAmountChange()})})},productAmountChange:function(){if(detailParams.spAttr&&detailParams.spAttr.isFreeload==1){require(["detailDeliveryService"],function(a){a.logic.init()
})}},resetBtnStauts:function(){if(jQuery("#addCart").size()>0){jQuery("#addCart").hide()}if(jQuery("#sellOut").size()>0){jQuery("#sellOut").hide()}if(jQuery("#seriesBtn_arrivalNotice").size()>0){jQuery("#seriesBtn_arrivalNotice").hide()}if(jQuery("#nowPanicBtn").size()>0){jQuery("#nowPanicBtn").hide()}if(jQuery("#presellBtn").size()>0){jQuery("#presellBtn").hide()}if(jQuery("#noPresellBtn").size()>0){jQuery("#noPresellBtn").hide()}if(jQuery("#oneKeyGoBtn").size()>0){jQuery("#oneKeyGoBtn").hide()}if(jQuery("#koCart").size()>0){jQuery("#koCart").hide()}if(jQuery("#storeNotifyBtn").size()>0){jQuery("#storeNotifyBtn").hide()}},getProductTags:function(){var a=URLPrefix.detailDomainAjax+"/ajaxGetProductTags.do";var b={"params.skuId":detailParams.skuId,"params.popType":detailParams.isPop,"params.area":cookieUtil.getYhdAreasCookie(),"params.channelId":0};
$.ajax({type:"get",url:a,dataType:"jsonp",data:b,jsonp:"callback",success:function(c){if(!c||c.code){return}var d=c.data;detailSku.getPromoTags(d.pts);if(!detailParams.productKO&&!detailSku.isReserveBuyProduct()&&!(detailParams.spAttr&&detailParams.spAttr.isYuShou=="1")){detailSku.getGrouponTags(d.gts)}detailSku.getProdActivityTag(d.pav)},error:function(){detailSku.getProdActivityTag()}})},getGrouponTags:function(b){if(b&&b.length==1){var a=b[0];if(a.skinImgUrl&&a.skinImgUrl.length>1){$("#grouponTagBanner").html('<img src="'+a.skinImgUrl+'">').show(0)}}},getCommonTags:function(a){if(!a||a.length<1){return}var c="";for(var b=0;b<a.length;b++){var d=a[b];c+='<a href="javascript:void(0);" style="" title="'+d.showName+'"><i class="iconDetail"></i>'+d.showName+"</a>"}$("#payServiceList").append(c)
},getPromoTags:function(b){if(b&&b.length==1){var a=b[0];if(a&&a.imgURL1){$("#bigPromoBanner").html('<img src="'+a.imgURL1+'">').show(0)}}},priceNotice:function(){if(!detailParams.spAttr||detailParams.spAttr.isPriceNotify!=1){return}var j=$(".priceNotice"),b=$("#J_priceNotice"),f=j.find(".nowprice_num"),d=j.find(".priceNotice_goods"),n=d.find("input"),m=d.find(".input_container"),h=j.find(".priceNotice_num"),g=h.find("input"),e=j.find(".priceNotice_popup_btn"),l=".priceNotice_error",i="priceNotice_error_status";var c=function(o){if(!o){return}var p=/[a-zA-Z]|[\u4e00-\u9fa5]/g;o=o.replace(p,"");if(o.length>0){var q=/\d+\.{0,1}\d{0,2}/g;o=o.match(q)[0]}if(!o){o=1}return o};var k=function(){m.removeClass(i);d.find(l).hide()};var a=function(){g.removeClass(i);h.find(l).hide()};n.on("keyup",function(){k();
var o=$(this).val();$(this).val(c(o))});g.on("keyup",function(){a();var o=$(this).val();$(this).attr("data-val",o)});b.on("click",function(){loginRelated.checkAndLogin(function(){loginRelated.getUserNotifyPhone(function(p){g.val((""+p).replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"));g.attr("data-val",p)});var o=detailSku.getCurShowPrice();f.html("¥ <span>"+o+"</span>");f.curPrice=o;detailPublic.popmeun(".priceNotice",null,function(){k();a();n.val("");g.val("");g.attr("data-val","")})})}).show();e.on("click",".confirm",function(){var r=n.val(),p=g.attr("data-val");var q=f.curPrice;if(r-0>q-0){m.addClass(i);d.find(l).html('<i class="iconDetail">&#xe606;</i>输入的期望价格必须低于当前售价<strong class="error_down_sku"></strong>').show();return}if(r==0||!validUtil.isPriceStr(r)){m.addClass(i);d.find(l).html('<i class="iconDetail">&#xe606;</i>输入的价格格式不正确<strong class="error_down_sku"></strong>').show();
return}k();if(!validUtil.isPhoneStr(p)){g.addClass(i);h.find(l).show();return}a();var o=URLPrefix.detailDomainAjax+"/priceSubscriber.do";var s={"params.skuId":detailParams.skuId,"params.area":cookieUtil.getYhdAreasCookie(),phoneNo:p,extParam:r};$.ajax({type:"get",url:o,data:s,dataType:"jsonp",timeout:2000,success:function(v){if(v&&v.code===0&&v.data){j.find(".jsclose").click();var t=v.data;if(t.rtnData){var u=t.rtnMsg?t.rtnMsg:"订阅成功";if(t.rtnCode==1){detailSku.followProduct.followRender()}popupUtil.successPopup(u);a();return}a();var u=t.rtnMsg?t.rtnMsg:"订阅失败";yhdLib.alert(u)}},error:function(){console.log("priceSubscriber error")}})})},getProdActivityTag:function(a){var b=detailParams.pName;$("#productMainName").attr("title",b);if(!detailParams.isPop){if(a&&a.imageUrl){$("#productMainName").html('<span class="self_icon">自营</span><img class="brand-day_logo" src="'+a.imageUrl+'">'+b)
}else{$("#productMainName").html('<span class="self_icon">自营</span>'+b)}}else{if(a&&a.imageUrl){$("#productMainName").html('<img src="'+a.imageUrl+'">'+b)}else{$("#productMainName").html(b)}}}};detailSku.followProduct={collectDiv:$("#product-collect"),iconNode:$("#product-collect .collect_icon"),textNode:$("#product-collect .collect_text"),init:function(){this.followStatus();this.collectDiv.on("click",function(){loginRelated.checkAndLogin(function(){detailSku.followProduct.changeEvent()})})},getData:function(b,d){var a=URLPrefix.detailDomainAjax+"/followProduct.do";var c={"params.skuId":detailParams.skuId,method:b};$.ajax({type:"get",url:a,data:c,dataType:"jsonp",timeout:2000,success:function(e){if(e&&e.code===0&&e.data){d(e.data)}},error:function(){console.log("followProduct error")}})},followStatus:function(){this.getData("get",function(a){if(a.rtnData){detailSku.followProduct.iconNode.addClass("collect_icon_active");
detailSku.followProduct.textNode.text("已关注")}})},follow:function(){this.getData("save",function(){detailSku.followProduct.followRender()})},followRender:function(){this.iconNode.addClass("collect_icon_active");this.textNode.text("已关注")},unfollow:function(){this.getData("remove",function(){detailSku.followProduct.iconNode.removeClass("collect_icon_active");detailSku.followProduct.textNode.text("关注")})},changeEvent:function(){if(this.iconNode.hasClass("collect_icon_active")){this.unfollow()}else{this.follow()}}};var detailPeExperience={lazyLoadProductExperienceInfo:function(){var c=jQuery("#productExperience").offset().top;var d=$(window);var a=d.height();var b=d.scrollTop();if(c-a-b<0){if($.trim(jQuery("#productExperience").html())==""){detailPeExperience.loadProductExperience()}jQuery(window).unbind("scroll",detailPeExperience.lazyLoadProductExperienceInfo)}},loadProductExperience:function(){if($("#productExperience").find("input").length>0){return}$("#productExperience").html("<p align='center'><img src=''/>请您稍等,数据正在加载...</p>");var a=detailParams.skuId;var b=URLPrefix.pe_yhd+"/squ/comment/getCommentDetail.do?productId="+a;$.ajax({type:"get",async:true,cache:true,timeout:10000,url:b,dataType:"jsonp",jsonpCallback:"commentDetailCallback",success:function(c){if(c&&c.value){$("#productExperience").html(c.value);
require(["css!"+URLPrefix.statics+"/comment/pc/css/pe.css"]);$("#productExperience").show();require([URLPrefix.statics+"/comment/pc/js/pe.js"])}},error:function(){console.log("评论获取失败")}})},getExperienceCountAndRate:function(){var a=URLPrefix.pe_yhd+"/squ/comment/getFuzzyProductCommentSummarys.do?productId="+detailParams.skuId;$.ajax({url:a,dataType:"jsonp",jsonpCallback:"experienceCountAndRateCallback",timeout:3000,cache:true,success:function(b){if(b.message=="success"&&b.data.success==true){var c=b.data.result.commentSummaries[0];if(c.GoodRateShow){$("#skuGoodCommentRate .paise .rate").html(c.GoodRateShow+"%");$("#skuGoodCommentRate .paise").show()}if(c.CommentCountStr){$("#skuGoodCommentRate .paise_num .yellow").html(c.CommentCountStr);$("#skuGoodCommentRate .paise_num").show();$("#sppj_fixed em").html("&nbsp;&nbsp;"+c.CommentCountStr);
$("#sppj em").html("&nbsp;&nbsp;"+c.CommentCountStr)}}},error:function(){console.log("getExperienceCountAndRate error")}})},forwardPL:function(a){if(a=="p"){$("#detail_desc_tab #sppj").click()}}};var detailProdDesc={lazyImgLoaded:false,lazyLoadedImgArr:[],lazyLoadedImgSize:6,lazyLoadedCheckTime:1000,init:function(){if(detailParams.isBookVideo){require(["detailProdDescImgPreview"],function(a){a.init()})}detailProdDesc.ajaxProdDesc()},ajaxProdDesc:function(){var a=$("#product_desc_tab_div_mask");a.html("<p align='center'>请您稍等,数据正在加载...</p>");var b=URLPrefix.detailDomain+"/squ/item/ajaxGetDesc.do?params.channelId=0&params.skuId="+detailParams.skuId+"&params.cat="+detailParams.categoryIds.join(",")+"&params.popType="+detailParams.isPop+"&params.venderId="+detailParams.venderId;$.ajax({url:b,dataType:"jsonp",jsonpCallback:"detailProdDescCallback",timeout:3000,cache:true,success:function(c){if(c.code==1){var e=c.data;for(var d=0;d<e.length;d++){switch(e[d].tabType){case 1:detailProdDesc.prodDescCallback(e[d]);
break;case 2:detailProdDesc.propCallback(e[d]);break;case 3:detailProdDesc.wrapCallback(e[d]);break;case 4:detailProdDesc.afterSaleCallback(e[d]);break}}}else{a.remove();console.log(c.data)}detailProdDesc.initPage()},error:function(){a.remove();console.log("get description error")}})},prodDescCallback:function(c){var a=$("#product_desc_tab_div_mask");var d=c.tabDetail||"";var b=/<map(.*?)map>/gm;d=d.replace(b,"");$("#prodDescTabContent #prodDetailCotentDiv .mod_des .desbox").before(c.ext||"");$("#prodDescTabContent #prodDetailCotentDiv .mod_des .desbox").append(d);$("#J_des").show();a.remove();jQuery(window).bind("scroll",detailPeExperience.lazyLoadProductExperienceInfo);detailProdDesc.initImgLazyLoadInfo();setTimeout(detailProdDesc.imgLazyLoad,detailProdDesc.lazyLoadedCheckTime)},propCallback:function(data){var html="";
var jsonArr=eval("("+data.tabDetail+")");if(!jsonArr){$("#J_des #detail_desc_tab #ggbz").hide();$("#J_fixedDes #detail_desc_tab_fixed #ggbz_fixed").hide();$("#prodDetailCotentDiv .s_standard_more").hide();return}jsonArr.sort(compare("sort"));for(var i=0;i<jsonArr.length;i++){var obj=jsonArr[i];var groupName=obj.groupName;var attsArr=obj.atts;attsArr.sort(compare("sort"));generateHtml(groupName,attsArr)}$("#J_des #detail_desc_prop").prepend(html);function generateHtml(groupName,attsArr){html+='<dl class="standard">';html+="<dt>"+groupName+"</dt>";for(var i=0;i<attsArr.length;i++){var attObj=attsArr[i];html+="<dd><label>"+attObj.attName+"</label>"+attObj.vals.join("；")+"</dd>"}html+="</dl>"}function compare(propertyName){return function(object1,object2){var value1=object1[propertyName];var value2=object2[propertyName];
if(value2<value1){return 1}else{if(value2>value1){return -1}else{return 0}}}}},wrapCallback:function(b){if(b&&b.tabDetail){var a='<p class="tit mt">'+b.tabName+"</p>";a+='<p class="con">'+b.tabDetail+"</p>";$("#J_des #detail_desc_prop").append(a)}},afterSaleCallback:function(data){var html="";var obj=eval("("+data.tabDetail+")");for(var key in obj){html+='<p class="tit">'+key+"</p>";html+='<p class="con">'+obj[key]+"</p>"}$("#J_des #detail_desc_fwcl").append(html)},initPage:function(){var f=$("#J_des");var b=$("#J_fixedDes");var d=$("#J_asideFixed");var c=$("#J_asideFixed .gotop");var e=$("#jsModDetailPreview").offset().top;var a=e+50;d.css({top:a,position:"absolute"});$(window).scroll(function(){var g=$("#J_des").offset().top;var i=$(window).scrollTop();var h=i-250;if(i>=g){b.show()}else{b.hide()
}if(i>e){d.css({top:250,position:"fixed"});$(".gotop").css({display:"block"})}else{d.css({top:a,position:"absolute"});$(".gotop").hide()}});detailProdDesc.sJtop()},onTabTitleClickEvent:function(b){var a=b.attr("tabIndex");jQuery("#detail_desc_content .desitem").hide();if(a!=3){jQuery("#detail_desc_fwcl").show();jQuery("#detail_desc_content .desitem[tabIndex='"+a+"']").show()}else{jQuery("#detail_desc_fwcl").hide();detailPeExperience.loadProductExperience()}},setPeCountNumber:function(a){a=detailTools.numberHidderWrapper(a,5);var b="评价&nbsp;<em>"+a+"</em>";$("#desc_sppj_fixed").html(b);$("#desc_sppj").html(b)},scrollToDivById:function(a){var b=$(a).offset().top;detailProdDesc.scrollToTop(b+2)},scrollToTop:function(a){$("body,html").animate({scrollTop:a},80)},initImgLazyLoadInfo:function(){jQuery("#prodDetailCotentDiv").find("img[original]").each(function(){var a=jQuery(this);
detailProdDesc.lazyLoadedImgArr.push(a)})},imgLazyLoad:function(){if(detailProdDesc.lazyLoadedImgArr==null||detailProdDesc.lazyLoadedImgArr.length<=0){return false}var f=jQuery(document).scrollTop()+jQuery(window).height();var a=detailProdDesc.lazyLoadedImgArr[0].offset().top;if(f-200<a){setTimeout(detailProdDesc.imgLazyLoad,detailProdDesc.lazyLoadedCheckTime);return true}var c=detailProdDesc.lazyLoadedImgArr.splice(0,detailProdDesc.lazyLoadedImgSize);for(var b=0;b<c.length;b++){var e=c[b];var d=e.attr("original");e.removeAttr("original");e.attr("src",d)}setTimeout(detailProdDesc.imgLazyLoad,detailProdDesc.lazyLoadedCheckTime);return true},sJtop:function(){var a=150},lazyLoadDescImg:function(){if(jQuery(document).scrollTop()>(jQuery("#prodDetailCotentDiv").offset().top-jQuery(window).height())){jQuery("#prodDetailCotentDiv img[original]").each(function(){var b=jQuery(this);
var a=b.attr("original");b.removeAttr("original");b.attr("src",a)});jQuery(window).unbind("scroll",detailProdDesc.lazyLoadDescImg);detailProdDesc.lazyImgLoaded=true}},onGuigeTabSwitchEvent:function(){var a=jQuery("#detail_desc_tab a[tabindex=1]");a.click()},bindDescTabClick:function(){jQuery("#detail_desc_tab .tab").click(function(c){var b=$(this);if(!b.hasClass("cur")){var a=b.index();$("#detail_desc_tab .tab").removeClass("cur").eq(a).addClass("cur");$("#detail_desc_tab_fixed .tab").removeClass("cur").eq(a).addClass("cur");detailProdDesc.onTabTitleClickEvent(b)}});jQuery("#detail_desc_tab_fixed .tab").click(function(c){var b=$(this);if(!b.hasClass("cur")){var a=b.index();$("#detail_desc_tab .tab").removeClass("cur").eq(a).addClass("cur");$("#detail_desc_tab_fixed .tab").removeClass("cur").eq(a).addClass("cur");
detailProdDesc.onTabTitleClickEvent(b);detailProdDesc.scrollToDivById("#J_des")}})}};var colorSizeFn={cfg:{skuid:detailParams.skuId,colorSize:detailParams.availAttrbutes},data:detailParams.availAttrbutes,res:{},spliter:"\u2299",r:{},keys:[],selectedCache:[],$el:$("#choose-attrs"),$attr:$("#choose-attrs").find("[data-type]"),$res:$("#choose-results"),selectedClass:"selected",disabledClass:"disabled",noStockClass:"no-stock",attrHLClass:"item-hl-bg",attrMax:6,attrOverflow:false,debug:false,decodeHTML:function(d){var c={"&amp;":"&","&lt;":"<","&gt;":">","&apos;":"'","&quot;":'"'};var b=d;for(var a in c){if(!c.hasOwnProperty(a)){continue}b=b.replace(new RegExp(a,"ig"),c[a])}return b},hasItem:function(a,c){if(a.indexOf){return a.indexOf(c)>-1}for(var b=0;b<a.length;b++){var d=a[b];if(c===d){return true}}return false},combineAttr:function(b,g){var d=[];var k={};for(var c=0;c<b.length;
c++){var h=b[c];var f=[];for(var a=0;a<g.length;a++){var e=g[a];if(!k[e]){k[e]=[]}if(!this.hasItem(k[e],h[e])){k[e].push(h[e])}f.push(h[e])}d.push({path:f.join(this.spliter),sku:h.skuId,stock:h.stock?1:0})}return{result:k,items:d}},getAllKeys:function(b){var a=[];for(var c=0;c<b.length;c++){a.push(b[c].path)}return a},powerset:function(b){var e=[[]];for(var d=0;d<b.length;d++){for(var c=0,a=e.length;c<a;c++){e.push(e[c].concat(b[d]))}}return e},buildResult:function(e){var d=this.getAllKeys(e);for(var c=0;c<d.length;c++){var n=d[c];var f=e[c].sku;var g=e[c].stock;var m=n.split(this.spliter);var a=this.powerset(m);for(var b=0;b<a.length;b++){var k=a[b];var l=k.join(this.spliter);if(!l){continue}var h=this.decodeHTML(l);if(this.res[h]){this.res[h].skus.push(f);this.res[h].stock+=g}else{this.res[h]={skus:[f],stock:g}
}}}},trimSpliter:function(e,c){var b=new RegExp("^"+c+"+","g");var a=new RegExp(c+"+$","g");var d=new RegExp(c+"+","g");return e.replace(b,"").replace(a,"").replace(d,c)},getSelectedItem:function(){var a=[];var b=this;b.$attr.each(function(){var c=$(this).find("."+b.selectedClass);if(c.length){a.push(c.attr("data-value").toString())}else{a.push("")}});return a},getStocks:function(g){var d=[];var f=this;for(var c=0;c<f.data.length;c++){var e=f.data[c];if(e.skuId){d.push(e.skuId)}}function a(h){return h&&(h==33||h==36)}function b(k){for(var j=0;j<f.data.length;j++){var l=f.data[j];if(k){var h=k[l.skuId];l.stock=h?a(h.StockState):true}else{l.stock=true}}}if(!d.length){return}if(d.length>100){d=d.slice(0,100)}$.ajax({url:URLPrefix.jd_item_stocks,dataType:"jsonp",data:{skuIds:d.join(","),area:this.getAreaId()},success:function(h){b(h);
g()}})},getAreaId:function(){var a=cookieUtil.getYhdAreasCookie();return a},updateStatus:function(b){this.setAllTitle();for(var e=0;e<this.keys.length;e++){var h=this.keys[e];var d=this.r.result[h];var a=b.slice();for(var c=0;c<d.length;c++){var k=d[c];if(b[e]==k){continue}a[e]=k;var l=this.trimSpliter(a.join(this.spliter),this.spliter);var g=this.$attr.filter('[data-type="'+h+'"]').find('[data-value="'+k+'"]');a[e]="「"+k+"」";var f=a.join("-");if(this.res[l]){g.removeClass(this.disabledClass);if(this.res[l].stock<1){g.addClass(this.noStockClass).attr("title",f+" 无货")}else{g.removeClass(this.noStockClass)}}else{g.addClass(this.disabledClass).attr("title",f+" 无此商品")}}}},handleUISelect:function(a){a.siblings().removeClass(this.selectedClass);a.addClass(this.selectedClass)},handleDisableClick:function(d){var a=d.parents("[data-type]").eq(0);
var g=a.data("idx");var e=a.data("type");var f=d.attr("data-value");d.removeClass(this.disabledClass);this.selectedCache[g]=f;this.$attr.not(a).find("[data-value]").removeClass(this.selectedClass);this.updateStatus(this.getSelectedItem());for(var b=0;b<this.keys.length;b++){var j=this.keys[b];var h=this.$el.find('[data-type="'+j+'"]');if(j==e){continue}var c=h.find('[data-value="'+this.selectedCache[b]+'"]');if(!c.hasClass(this.disabledClass)){c.addClass(this.selectedClass);this.updateStatus(this.getSelectedItem())}}},onDisableClick:function(){},highLighAttr:function(){for(var c=0;c<this.keys.length;c++){var b=this.keys[c];var a=this.$el.find('[data-type="'+b+'"]');if(a.find("."+this.selectedClass).length<1){a.addClass(this.attrHLClass);this.onDisableClick()}else{a.removeClass(this.attrHLClass)
}}},getItemSku:function(f){for(var b=0;b<this.data.length;b++){var g=this.data[b];var a=true;for(var e=0;e<this.keys.length;e++){var c=this.keys[e];if(g[c]!==f[e]){a=false;break}}if(a){return g.skuId}}return false},bindEvent:function(){var b=this;function c(f){var e=f.hasClass(b.disabledClass);if(e){b.handleDisableClick(f)}else{b.selectedCache[f.parents("[data-type]").eq(0).data("idx")]=f.val()}b.updateStatus(b.getSelectedItem());b.highLighAttr();b.handleResult()}function a(){var f=b.$el.find("."+b.selectedClass).length;if(f>=b.keys.length){var e=b.getSelectedItem();var g=b.getItemSku(e);if(g){b.goToPage(g)}else{}}}function d(f){var e=f.hasClass("."+b.selectedClass);if(!e){b.handleUISelect(f);if(b.attrOverflow){a(f)}else{c(f)}}}this.$el.undelegate().delegate("[data-value]","click",function(){d($(this))
})},checkExists:function(){var a=this;a.$el.find("[data-value]").each(function(){var b=$(this).attr("data-value");if(!a.res[b]&&!$(this).hasClass(a.selectedClass)){$(this).addClass(a.disabledClass)}})},goToPage:function(a){$(".crumb-wrap").attr("id","crumb-wrap");location.href=URLPrefix.detailDomain+"/"+a+".html"+location.search+"#crumb-wrap"},showResult:function(a){this.$res.show().find(".dd").html(a)},handleResult:function(){var a=this.getSelectedItem();var c=[];for(var b=0;b<a.length;b++){var d=a[b];if(!!d){c.push(d)}}if(c.length){if(c.length<this.keys.length){detailSku.resetBtnStauts();$("#seriesBtn_arrivalNotice").show()}else{if(c.length==this.keys.length){var e=this.res[c.join(this.spliter)];if(this.debug){this.showResult(c.join(" - ")+"<br/>skuId:"+e.skus[0])}else{if(e&&this.cfg.skuid==e.skus[0]){detailSku.resetBtnStauts();
$(".btn_init_class").each(function(){if($(this).attr("btn_init_flag")){$(this).show()}})}else{if(e&&this.cfg.skuid!=e.skus[0]){this.goToPage(e.skus[0])}}}}}}},getKeys:function(){var a=this;this.$attr.each(function(){var b=$(this).data("type");if(b){a.keys.push(b)}});if(this.keys.length>this.attrMax){this.attrOverflow=true}},setTitle:function(a){var b=a.attr("data-value");if(b){a.attr("title",b)}},setAllTitle:function(){var a=this;this.$el.find(".item").each(function(){a.setTitle($(this))})},reset:function(){this.res={};this.keys=[];this.selectedCache=[];this.r={};this.$el.find("[data-value]").removeClass(this.disabledClass).removeClass(this.noStockClass);this.$attr.removeClass(this.attrHLClass)},initAttrSelection:function(){if(!this.data){return false}this.reset();this.getKeys();this.bindEvent();
var a=this;if(!a.attrOverflow){a.selectedCache=a.getSelectedItem();a.getStocks(function(){a.r=a.combineAttr(a.data,a.keys);a.buildResult(a.r.items);a.checkExists();a.updateStatus(a.getSelectedItem());if(a.debug){a.handleResult()}if(/debug=res/.test(location.href)){console.log(a.res);console.log(a.selectedCache)}})}},handleSerialProductPicture:function(){$(".detail_serial_product_pic_class").each(function(){var a=$(this).attr("original_src");var b=YhdImgUtil.getYhdImgUrlByPath(detailParams.skuId,30,30,a,0);$(this).attr("src",b)})},init:function(){if(!this.$el.length){return false}$("#sku_unit").show();this.handleSerialProductPicture();this.initAttrSelection()}};var detailProdCombine={ajaxProductCombineFit:function(){var b={sku:detailParams.skuId,cat:detailParams.categoryIds.join(","),area:cookieUtil.getYhdAreasCookie()};var a=URLPrefix.jd_item_suit;$.ajax({type:"get",url:a,dataType:"jsonp",data:b,jsonp:"callback",scriptCharset:"gbk",success:function(c){if(c.suit&&c.suit.status==200&&c.suit.data){var d=c.suit.data;detailProdCombine.renderCombine(d)}}})},renderCombine:function(e){if(e.packList&&e.packList.length>0){var h="";var a="";var m="";var k=e.packList;var g=0;for(var f=0;f<k.length;f++){var o=k[f];var b=o.suitType;var l=o.packId;var n=o.poolList;if(b==1&&n&&n.length>0){g++;a+='<li class="ktab" combine_pack_id="'+l+'">';a+="<span>套餐"+g+"</span>";a+='<sub class="on">对勾</sub>';a+="</li>";m+='<div class="choise_kit_item">';m+='<div class="scrollbox clearfix">';
m+='<div class="barbox">';for(var c=0;c<n.length;c++){var d=n[c].colorList[0];m+='<ul class="clearfix">';m+="<li>";if(c!=0){m+="<ins></ins>"}m+='<a class="kit_list_img" target="_blank" href="javascript:void(0);" title="'+d.skuName+'">';m+='<img width="80px" height="80px" src="//img13.360buyimg.com/n9/s80x80_'+d.skuPicUrl+'">';m+="</a>";m+='<div class="kit_list_des" style="padding-top:30px;">';m+='<a title="'+d.skuName+'" class="kit_list_tit" target="_blank" href="javascript:void(0);">';m+=d.skuName;m+="</a>";m+='<p class="kit_list_pr"></p>';if(d.count&&d.count>1){m+='<em style="left:5px;right:auto;" class="pack_kit">'+d.count+"件</em>"}m+="</div>";m+="</li>";m+="</ul>"}m+="</div>";m+="</div>";m+='<div class="choise_kit_save clearfix">';m+='<span class="choise_kit_save_total">总价：<strong id="choise_combine_total_num_'+l+'"></strong></span>';
m+='<span class="btnbox">';m+='<a href="javascript:void(0);" class="add_cart" style="display:none;" id="combineBtn_'+l+'">';m+="<span>购买套餐</span>";m+="</a>";m+="</span>";m+="</div>";m+="</div>"}}if(a!=""){h+='<dl class="clearfix">';h+="<dt>套餐</dt>";h+="<dd>";h+='<ul class="tagsInBox clearfix">';h+=a;h+="</ul>";h+="</dd>";h+="</dl>";h+='<div class="choise_kit_list">';h+=m;h+="</div>"}if(h!=""){$("#firstScreenCombine").html(h);$("#firstScreenCombine").show();detailProdCombine.choiseCombineKit()}}},getCombinePrice:function(a){var c={"params.area":cookieUtil.getYhdAreasCookie(),"params.skuIds":a};var b=URLPrefix.detailDomainAjax+"/getPrices.do";$.ajax({type:"get",url:b,dataType:"jsonp",data:c,jsonp:"callback",success:function(d){if(d&&d.data&&d.data.length>0){var g=d.data;var f=g[0].p;var e=g[0].type;
if(e&&e==1){$("#choise_combine_total_num_"+a).html("<em>¥</em>"+g[0].msg)}else{if(f&&f>0){$("#choise_combine_total_num_"+a).html("<em>¥</em>"+f);$("#combineBtn_"+a).show()}}}}})},choiseCombineKit:function(){var c=$("#firstScreenCombine");jQuery("#sku_unit").show();var d=c.find(".choise_kit_item"),f=c.find(".choise_kit_list");var e=c.find("dl li");var b,a;if(d.size()<=0||f.size()<=0){return}e.bind("click",function(){var l=$(this).index();if($(this).hasClass("selected")){$(this).removeClass("selected");f.hide();d.removeClass("cur");jQuery("#computingArea").show()}else{var j=$(this).attr("combine_pack_id");detailProdCombine.getCombinePrice(j);$("#combineBtn_"+j).unbind();require(["common_cart"],function(i){$("#combineBtn_"+j).bind("click",function(){var m={pid:j,ptype:"1",pcount:1,sku:"",did:"",zids:"",gids:""};
i.addToCart(m)})});$(this).addClass("selected").siblings(".selected").removeClass("selected");f.find(".choise_kit_save").show();f.show();var k=d.eq(l);k.addClass("cur").siblings().removeClass("cur");var h=k.find("li").length;var g=k.find("li").outerWidth(true);k.find("ul").css({width:g});k.find(".barbox").css({width:g*h});jQuery("#computingArea").hide()}})}};var detailProdYanbao={ajaxYanBaoProdInfo:function(){var a=URLPrefix.jd_item_yanbao;var b={skuId:detailParams.skuId,cat:detailParams.categoryIds.join(","),area:cookieUtil.getYhdAreasCookie(),brandId:detailParams.brandId};$.ajax({url:a,type:"get",dataType:"jsonp",data:b,scriptCharset:"gbk",jsonp:"callback",success:function(e){if(e&&e[b.skuId]&&e[b.skuId].length>0){var h=e[b.skuId];for(var d=0;d<h.length;d++){var f=new Array();var g=h[d];f.push('<div id="yanbao_id_'+d+'" class="serbox none">');f.push('<div class="warrantychoise">');f.push('<div class="choisecon"  ybPmid="'+g.details[0].bindSkuId+'" ybName="'+g.details[0].bindSkuName+'" ybPrice="'+g.details[0].price+'">');f.push('<span data-tag="y00" class="select_tit">'+g.details[0].bindSkuName.slice(0,6)+"：<em>&yen"+g.details[0].price+'<i class="iconDetail">&#xe603;</i></em></span></div>');
f.push('<input autocomplete="off"  id="focusWarrantInput" style="width:0;border:1px;border-bottom-style:none;border-top-style:none;border-left-style:none;border-right-style:none;"> ');f.push('<div class="warrantylist" tabindex="-1">');for(var c=0;c<g.details.length;c++){f.push('<a data-tag="y0'+(c+1)+'" href="javascript:void(0);" ybPmid="'+g.details[c].bindSkuId+'" ybName="'+g.details[c].bindSkuName+'" ybPrice="'+g.details[c].price+'" title="'+g.details[c].tip+"："+g.details[c].price+'元" >'+g.details[c].bindSkuName+"：<em>&yen"+g.details[c].price+"</em></a>")}f.push("</div>");f.push("</div>");f.push("</div>");$("#warranty .tagsInBox").append(f.join(""));detailProdYanbao.warrantyService(jQuery("#yanbao_id_"+d));jQuery("#yanbao_id_"+d).show()}$("#warranty").show();jQuery("#sku_unit").show()}},error:function(c){console.log("load yanbao info error")
}})},warrantyService:function(e){var a=$(e);var d=a.find(".warrantychoise");var i=d.find(".choisecon");var h=d.find(".warrantylist"),c=h.find("a"),g=$(document),b=true;if(c.length<1){i.parents(".serbox").addClass("alone");f();return false}g.click(function(k){var j=$(k.target);if(d.is(":visible")&&j.attr("class")!="warrantylist"){d.removeClass("hover")}});c.off("click").on("click",function(q){q.stopPropagation();b=true;var r=$(this).parents(".warrantylist");var k=r.siblings(".choisecon");var o=k.find(".select_tit");var j=i.find(".select_tit").html();var s=i.find(".select_tit").attr("data-tag");var n=$(this);var u=n.html();var t=n.attr("ybPmid");var p=n.attr("ybName");var m=n.attr("ybPrice");var w=n.attr("data-tag");var v=n.parents(".warrantychoise");if(n.hasClass("cur")){u=r.find("a").eq(0).html()
}var l=u.split("：");u=l[0].slice(0,6)+"："+l[1];i.find(".select_tit").html(u+'<i class="iconDetail">&#xe603;</i>');i.attr("ybPmid",t);i.attr("ybName",p);i.attr("ybPrice",m);n.toggleClass("cur").siblings().removeClass("cur");n.find("i").remove();o.attr("data-tag",w);if(r.find(".cur").length===0){v.removeClass("sel")}else{v.addClass("sel")}v.removeClass("hover")});if(detailPublic.isPc()){d.off("mouseover").on("mouseover",function(k){var l=$(this);k.stopPropagation();l.removeClass("sel");var j=l.find(".warrantylist");if(j.find(".cur").length>0){l.addClass("fontbold")}if(j.width()<d.width()-2){j.width(d.width()-2)}l.addClass("hover")}).off("mouseout").on("mouseout",function(k){var l=$(this);var j=l.find(".warrantylist");k.stopPropagation();if(j.find(".cur").length>0){l.addClass("sel")}l.removeClass("hover fontbold")
});i.off("click").on("click",function(){var m=$(this);var j=m.parents(".warrantychoise");var l=m.siblings(".warrantylist");var k=l.find("a").eq(0);var n=l.find(".cur").index();if(l.find(".cur").length>0){j.removeClass("sel");k.click();if(n!==0){k.click()}}else{j.addClass("sel");k.click()}j.removeClass("hover")})}else{i.off("click").on("click",".select_tit",function(j){var k=$(this);j.stopPropagation();d=k.parents(".warrantychoise");k.parents(".warrantychoise").removeClass("sel");if(h.width()<d.outerWidth(true)-2){h.width(d.outerWidth(true)-2)}if(k.parents(".warrantychoise").hasClass("hover")){k.parents(".warrantychoise").removeClass("hover")}else{$(".serbox").find(".warrantychoise").removeClass("hover");k.parents(".warrantychoise").addClass("hover")}})}function f(){i.off("click").on("click",function(){var k=$(this);
var j=k.parents(".warrantychoise");if(j.hasClass("sel")){j.removeClass("sel")}else{j.addClass("sel")}j.removeClass("hover")}).on("mouseover",function(){var k=$(this);var j=k.parents(".warrantychoise");j.addClass("alonehover")}).on("mouseout",function(){var k=$(this);var j=k.parents(".warrantychoise");j.removeClass("alonehover")})}}};var detailPmsRecomm={pmsRightArrays:[],rightIndex:0,rightLength:0,userPin:"",ajaxPersonalizationPms:function(d){if(!d){return}var e=130000;var f=10;switch(d){case"seeAndSee":e=619118;f=20;break;case"rankList":e=619121;f=10;break;case"buyAndBuy":e=619119;f=10;break;case"finallyBuy":e=619120;f=10;break;case"noGoods":e=619122;f=4;break}var c=cookieUtil.getCookie("provinceId")||2;var b=cookieUtil.getCookie("cityId");var a=URLPrefix.detailDomain+"/squ/item/ajaxGetRecommendInfo.do?reParams.provinceId="+c+"&reParams.cityId="+b+"&reParams.lim="+f+"&reParams.p="+e+"&reParams.skuId="+detailParams.skuId+"&reParams.channelId=0";$.ajax({url:a,dataType:"jsonp",jsonpCallback:"PmsCallback"+d,timeout:3000,cache:true,success:function(i){var g=i.data;if(i.code!=0||!g||!g.data||g.success==false){return}var h="";
if(d=="seeAndSee"){h=detailPmsRecomm.createSeeAndSeeRecommHtml(g);if(h){$("#r_mod #r_mod_change").append(h);$("#r_mod").show();if($("#r_cha_t").size()>0){$("#r_cha_t").click(function(){detailPmsRecomm.refershSeeAndSeeHtml()})}}}else{if(d=="rankList"){h=detailPmsRecomm.createRankListRecommHtml(g);if(h){$("#detail_hot10Recomm").append(h).show()}}else{if(d=="buyAndBuy"){h=detailPmsRecomm.createLeftRecommHtml(g,"购买了此商品的用户还买了");if(h){$("#detail_buyAndBuyRecomm").append(h).show()}}else{if(d=="finallyBuy"){h=detailPmsRecomm.createLeftRecommHtml(g,"看了本商品的用户最终购买了");if(h){$("#detail_viewAndBuyRecomm").append(h).show()}}else{if(d=="noGoods"){h=detailPmsRecomm.createNoGoogsRecommHtml(g);if(h){$("#noGoodscommand").append(h).show()}}}}}}},error:function(){console.log("pms recommend error, the type is: "+d)
}})},createSeeAndSeeRecommHtml:function(d){var f=d.data;var b=f.length>10?10:f.length;if(b==0){return null}detailPmsRecomm.rightLength=b;var g=new Array();g.push('<div class="cha_t">看了还看');if(b>3){g.push('<a clstag="pageclick|keycount|product_201709214|12" href="javascript:void(0);" id="r_cha_t"><span class="iconDetail">&#xe60e;</span>换一批</a>')}g.push('</div><ul clstag="pageclick|keycount|product_201709214|13" class="cha_m" id="r_cha_m">');var c=g.join("");for(var h=0;h<b;h++){var k=f[h];if(!k.sku){continue}var a=[];a.push('<li data-needReflushType="0" skuId="'+k.sku+'">');a.push('<a class="chaImg" target="_blank" href="'+URLPrefix.detailDomain+"/"+k.sku+'.html"><img src="'+k.img+'" width="120" height="120"></a>');a.push('<p class="cha_tit"><a target="_blank" title="'+k.t+'" href="'+URLPrefix.detailDomain+"/"+k.sku+'.html">'+k.t+"</a></p>");
a.push("<p class=\"cha_price\"><a target=\"_blank\" href=\"' + URLPrefix.detailDomain + '/' + record.sku + '.html' + '\">");if(k.type==1){a.push('&yen;<span class="j_price">'+k.msg+"</span>")}else{a.push('&yen;<span class="j_price">'+k.jp+"</span>")}a.push("</a></p>");a.push("</li>");detailPmsRecomm.pmsRightArrays.push(a.join(""))}var m=[];var l=b>3?3:b;for(var e=0;e<l;e++){m.push(detailPmsRecomm.pmsRightArrays[e]);detailPmsRecomm.rightIndex++}return c+m.join("")+"</ul>"},refershSeeAndSeeHtml:function(){var d=new Array();var c=3;var a=detailPmsRecomm.pmsRightArrays.length>c?c:detailPmsRecomm.pmsRightArrays.length;for(var b=0;b<a;b++){detailPmsRecomm.rightIndex=detailPmsRecomm.rightIndex%detailPmsRecomm.rightLength;d.push(detailPmsRecomm.pmsRightArrays[detailPmsRecomm.rightIndex]);detailPmsRecomm.rightIndex++
}$("#r_cha_m").html(d.join(""))},createRankListRecommHtml:function(c){var g="<dt><i></i>顾客最喜爱商品排行榜</dt>";var f=c.data;var e=[];var a=f.length>5?5:f.length;if(a<=4){return null}for(var d=0;d<a;d++){var b=f[d];if(!b.sku){continue}e.push('<dd data-hover="hover" class="bordernone" data-needReflushType="0" skuId="'+b.sku+'"><span>');e.push('<a class="pic" href="'+URLPrefix.detailDomain+"/"+b.sku+'.html" target="_blank" title="'+b.t+'"><img src="'+b.img+'" width="115" height="115"></a>');e.push('<a class="tit" href="'+URLPrefix.detailDomain+"/"+b.sku+'.html" target="_blank" title="'+b.t+'">'+b.t+"</a>");if(b.type&&b.type==1){e.push('<ins>&yen;<t class="j_price">'+b.msg+"</t></ins>")}else{e.push('<ins>&yen;<t class="j_price">'+b.jp+"</t></ins>")}e.push('<a class="commandbtn" target="_blank" href="'+URLPrefix.detailDomain+"/"+b.sku+'.html">查看详情</a>');
e.push("</span>");e.push('<div class="exp_ico ');if(d==0){e.push("one")}else{if(d==1){e.push("two")}else{if(d==2){e.push("three")}else{e.push("rank")}}}e.push('">'+(d+1));e.push("</div></dd>")}return g+e.join("")},createLeftRecommHtml:function(c,g){var e=[];var f=c.data;var a=f.length>=6?6:f.length;if(a==0){return null}e.push('<div class="box_hd"><strong>'+g+"</strong></div>");e.push('<div class="box_list"><ul>');for(var d=0;d<a;d++){var b=f[d];if(!b.sku){continue}e.push('<li data-needReflushType="0" skuId="'+b.sku+'">');e.push('<a class="pro_img" href="'+URLPrefix.detailDomain+"/"+b.sku+'.html" target="_blank" title="'+b.t+'"><img src="'+b.img+'" width="115" height="115"></a>');e.push('<p class="pro_tit"><a href="'+URLPrefix.detailDomain+"/"+b.sku+'.html" title="'+b.t+'" target="_blank">'+b.t+"</a></p>");
if(b.type&&b.type==1){e.push('<p class="pro_price"><span class="color_red">&yen;<span class="j_price">'+b.msg+"</span></span>")}else{e.push('<p class="pro_price"><span class="color_red">&yen;<span class="j_price">'+b.jp+"</span></span>")}e.push('<a class="commandbtn" target="_blank" href="'+URLPrefix.detailDomain+"/"+b.sku+'.html">查看详情</a>');e.push("</p>");e.push("</li>")}e.push("</ul></div>");return e.join("")},createNoGoogsRecommHtml:function(c){var e=[];var f=c.data;var a=f.length>2?2:f.length;e.push("<dl>");e.push('<dt class="tit"><i></i><span>该商品暂时缺货，我们猜您喜欢以下商品</span></dt>');e.push('<dd class="clearfix">');for(var d=0;d<a;d++){var b=f[d];if(!b.sku){continue}e.push('<div class="favitem" data-needReflushType="0" skuId="'+b.sku+'">');e.push('<a class="favimg" title="'+b.t+'" target="_blank" href="'+URLPrefix.detailDomain+"/"+b.sku+'.html"><img src="'+b.img+'"></a>');
e.push("<p>");e.push('<a target="_blank" title="'+b.t+'" href="'+URLPrefix.detailDomain+"/"+b.sku+'.html">'+b.t+"</a>");e.push('<span class="fav_price">');if(b.type&&b.type==1){e.push('<span class="npr"><em>¥</em><span class="j_price">'+b.msg+"</span></span>")}else{e.push('<span class="npr"><em>¥</em><span class="j_price">'+b.jp+"</span></span>")}e.push("</p></div>")}e.push(" </dd></dl>");return e.join("")}};var detailVenderInfo={ajaxGetVenderInfo:function(){var a=URLPrefix.detailDomain+"/squ/item/ajaxGetVenderInfo.do?params.channelId=0&params.venderId="+detailParams.venderId+"&params.popType="+detailParams.isPop;$.ajax({url:a,timeout:3000,cache:true,success:function(b){$(".fm_detail_two .grid_4").prepend(b);var c="";var d="";if(detailParams.isPop){c=$("#mod_inshop_box strong a").html()||"";d=$("#mod_inshop_box strong a").attr("href")||"javascript:;"}else{c=$(".mod_inshop_DSR .shop_name a").html()||"";d=$(".mod_inshop_DSR .shop_name a").attr("href")||"javascript:;"}if(c){$("#detail_desc_shopname_fixed").html(c);$("#detail_desc_shopname_fixed").attr("title",c);$("#detail_desc_shopname_fixed").attr("href",d)}else{$(".des .des_search").css("visibility","hidden")}if(detailParams.isPop){detailVenderInfo.checkVenderServiceStatus()
}},error:function(){console.log("get vender info error")}})},bindVenderService:function(){loginRelated.checkAndLogin(detailVenderInfo.venderServiceToken)},venderServiceToken:function(){var a=URLPrefix.detailDomainAjax+"/ajaxGetOnlineServiceToken.do?originUrl="+window.location.href;$.ajax({url:a,dataType:"jsonp",timeOut:2000,success:function(b){if(b&&b.code==0){var d=b.data.loginToken;var c=b.data.fp;detailVenderInfo.openVenderService(d,c)}else{console.log("ajaxGetOnlineServiceToken return failure")}},error:function(){console.log("get online service token error")}})},openVenderService:function(c,b){var a="//chat.jd.com/index.action?venderId="+detailParams.venderId+"&pid="+detailParams.skuId+"&customerAppId=yhd.customer&entry=jd_web_yhd_item&aspid=110.102.0000001.01&loginToken="+c+"&fp="+b;window.open(a)
},checkVenderServiceStatus:function(){var a="//chat1.jd.com/api/checkChat?pid="+detailParams.skuId+"&returnCharset=utf-8";$.ajax({url:a,dataType:"jsonp",jsonp:"callback",success:function(b){if(b.code==3){$(".box_bd .dsr_online .offline_statu").show();$("#detail_dzd_faq_fixed .offline_statu").show();$("#prismIm").on("click",detailVenderInfo.bindVenderService);$("#prismIm").show()}else{if(b.code==1){$(".box_bd .dsr_online .online_statu").show();$("#detail_dzd_faq_fixed .online_statu").show();$("#prismIm").on("click",detailVenderInfo.bindVenderService);$("#prismIm").show()}else{$(".box_bd .dsr_online").hide();$("#detail_dzd_faq_fixed").hide()}}},error:function(){$(".box_bd .dsr_online").hide();$("#detail_dzd_faq_fixed").hide();console.log("check online service status error")}})}};var detailPromotion={promotion_title_index:0,promotion_content_index:0,curDate:new Date().getTime(),init:function(){detailPromotion.ajaxPromotionInfo()},ajaxPromotionInfo:function(){var a=URLPrefix.detailDomainAjax+"/ajaxGetPromoInfo.do";var b={"params.skuId":detailParams.skuId,"params.venderId":detailParams.venderId,"params.area":cookieUtil.getYhdAreasCookie(),"params.channelId":0};$.ajax({type:"get",url:a,data:b,timeout:6000,dataType:"jsonp",jsonp:"callback",success:function(c){if(c&&c.code==0&&c.data){var d=c.data;if(d&&d.promoList){detailPromotion.reduceScrollbar(d.promoList)}}}})},reduceScrollbar:function(b){$("#detailPromotion").html("");$("#detailPromotion").hide();if(b){var a=new Array();$.each(b,function(g,n){var h=n.type;var l=n.promoLevels;var k=detailPromotion.checkPromoTime(l);
if(k.length>0){if(h==8){detailPromotion.promotion_content_index++;a.push('<div class="promotionLayer" id="promotion_index_'+detailPromotion.promotion_content_index+'" style="display:none;">');a.push('<div class="title clearfix"><i class="close" promotion_name="promotion_index_'+detailPromotion.promotion_content_index+'">关闭</i>');a.push('<div class="msg"><span class="sub">'+k[0].name+'</span>共<span class="yow">'+k.length+"</span>项，"+k[0].name+"信息</div>");a.push("</div>");a.push('<div class="Layer_main presented scrolly">');for(var f=0;f<k.length;f++){var m=k[f];a.push('<dl class="clearfix  inBox">');a.push("<dt>");a.push('<p class="sale_con">'+m.content+"</p>");a.push("</dt>");a.push('<dd class="clearfix">');if(m.gifts&&m.gifts.length>0){for(var d=0;d<m.gifts.length;d++){var e=m.gifts[d];a.push('<div class="prd clearfix">');
var c=URLPrefix.detailDomain+"/"+e.sid+".html";a.push('<a  href="javascript:void(0);">');a.push('<img width="58" height="58" src="'+YhdImgUtil.getYhdImgUrlByPath(e.sid,58,58,e.mp,0)+'">');a.push("</a>");a.push('<p class="p_1">');a.push('<a  href="javascript:void(0);" title="'+e.nm+'">'+e.nm+"</a>");a.push("</p>");a.push('<p class="p_2">');a.push('<span class="red">'+e.num+"件</span>");a.push("<p>");a.push("</div>")}}a.push("</dd>");a.push("</dl>")}a.push("</div>");a.push("</div>")}else{if(h==1||h==11||h==10||h==15){for(var f=0;f<k.length;f++){detailPromotion.promotion_content_index++;var m=k[f];a.push('<div class="promotionLayer" id="promotion_index_'+detailPromotion.promotion_content_index+'" style="display:none;">');a.push('<div class="title clearfix"><i class="close"  promotion_name="promotion_index_'+detailPromotion.promotion_content_index+'">关闭</i>');
a.push('<div class="msg"><span class="sub">'+m.name+'</span>共<span class="yow">'+1+"</span>项，"+m.name+"信息</div>");a.push("</div>");a.push('<div class="Layer_main">');a.push('<ul class="reduce">');a.push("<li>");a.push('<span style="max-width: 360px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;display: inline-block;line-height: 1;" title="'+m.content+'">'+m.content+"</span>");a.push("</li>");a.push("</ul>");a.push("</div>");a.push("</div>")}}else{detailPromotion.render2to7Dom(k,a,h)}}}});if(a.length>0){a.push('<dl class="clearfix">');a.push("<dt>促销</dt>");a.push('<dd id="promotion_title">');$.each(b,function(d,h){var g=h.type;var j=h.promoLevels;var f=detailPromotion.checkPromoTime(j);if(f.length>0){if(g==1||g==11){for(var e=0;e<f.length;e++){var c=f[e];detailPromotion.renderPromTitle(c,1,a,g)
}}else{var c=f[0];detailPromotion.renderPromTitle(c,f.length,a,g)}}});a.push("</dd>");a.push("</dl>")}if(a.length>0){$("#detailPromotion").html(a.join(""));detailPromotion.reduceScrollbar_new();$("#detailPromotion").show()}}},checkPromoTime:function(d){var c=[];for(var b=0;b<d.length;b++){var a=d[b];if(detailPromotion.curDate>=a.st*1000&&detailPromotion.curDate<=a.d*1000){c.push(a)}}return c},renderPromTitle:function(b,a,d,c){detailPromotion.promotion_title_index++;d.push('<div class="list clearfix">');d.push('<a href="javascript:void(0);" class="fr" promotion_name="promotion_index_'+detailPromotion.promotion_title_index+'">共<span class="yow">'+a+'</span>项，展开查看<span class="iconDetail">&#xe603;</span></a>');d.push('<div class="fl">');d.push('<span class="sub">'+b.name+"</span>");d.push('<span class="tit" title="'+b.content+'">'+b.content+"</span>");
if(c==14){d.push('<a  target="_blank" class="link" href="'+b.adUrl+'">详情</a>')}else{if(c!=8&&c!=1&&c!=10&&c!=11&&c!=15){d.push('<a  target="_blank" class="link" href="'+b.adUrl+'">立即参加</a>')}}d.push("</div>");d.push("</div>")},render2to7Dom:function(e,d,c){detailPromotion.promotion_content_index++;d.push('<div class="promotionLayer" id="promotion_index_'+detailPromotion.promotion_content_index+'" style="display:none;">');d.push('<div class="title clearfix"><i class="close"  promotion_name="promotion_index_'+detailPromotion.promotion_content_index+'">关闭</i>');d.push('<div class="msg"><span class="sub">'+e[0].name+'</span>共<span class="yow">'+e.length+"</span>项，"+e[0].name+"信息</div>");d.push("</div>");d.push('<div class="Layer_main">');d.push('<ul class="reduce">');for(var b=0;b<e.length;b++){var a=e[b];
d.push("<li>");d.push('<span style="max-width: 360px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;display: inline-block;line-height: 1;" title="'+a.content+'">'+a.content+"</span>");if(c==14){d.push('<a target="_blank" href="'+a.adUrl+'" class="link">详情</a>')}else{d.push('<a target="_blank" href="'+a.adUrl+'" class="link">立即参加</a>')}d.push("</li>")}d.push("</ul>");d.push("</div>");d.push("</div>")},reduceScrollbar_new:function(){var a=$("#jsModInformation"),c=a.find(".mod_detailInfo_promotion dd .list .fr"),b=a.find(".mod_detailInfo_promotion .promotionLayer .title .close");c.click(function(){var d=$(this).attr("promotion_name");$("#"+d).show()});b.click(function(){var d=$(this).attr("promotion_name");$("#"+d).hide()})}};var detailCoupon={joinCouponData:{},loginStatus:false,init:function(){var b={isCanUseJQ:(detailParams.spAttr&&detailParams.spAttr.isCanUseJQ==0)?0:1,isCanUseDQ:(detailParams.spAttr&&detailParams.spAttr.isCanUseDQ==0)?0:1,isOverseaPurchase:(detailParams.spAttr&&!detailParams.spAttr.isOverseaPurchase)?1:0};var a=URLPrefix.detailDomainAjax+"/ajaxGetCouponInfo.do";var c={"params.skuId":detailParams.skuId,"params.cat":detailParams.categoryIds.join(","),"params.venderId":detailParams.venderId,"params.channelId":0,"params.popType":detailParams.isPop,isCanUseJQ:b.isCanUseJQ,isCanUseDQ:b.isCanUseDQ,isOverseaPurchase:b.isOverseaPurchase};$.ajax({url:a,data:c,dataType:"jsonp",jsonpCallback:"couponCallback",timeout:6000,success:function(d){if(d){detailCoupon.initCouponVouchers(d)}}})},initCouponVouchers:function(b){$("#detailCoupon").html("");
$("#detailCoupon").hide();var c=new Array();if(!b.code&&b.data&&(b.data.joinAs||b.data.skuCs)){var e=b.data;var d=e.joinAs?e.joinAs.length:0;var a=e.skuCs?e.skuCs.length:0;c.push(' <dl class="suit clearfix">');c.push(" <dt>优惠券</dt>");c.push(' <dd id="coupon_dd_title_id">');c.push(' <div class="container-coupons-detail">');c.push(' <div class="_default">');c.push(' <div class="_left">');detailCoupon.getCounDesc(c,e);c.push("  </div>");c.push(' <div class="_right" clstag="pageclick|keycount|product_201709214|31">');c.push(" <span>领取优惠券</span>");c.push(' <i class="iconDetail">&#xe603;</i>');c.push(" </div></div>");c.push(' <div class="_default_active">');c.push(' <div class="_left">领取优惠券</div>');c.push(' <div class="_right">关闭</div>');c.push(" </div>");c.push('<div id="couponListDiv_id" class="container-coupons-select">');
if(e.joinAs&&e.joinAs.length>0){detailCoupon.initFingerPrint();detailCoupon.bulidCouponByType(c,e.joinAs,0);detailCoupon.joinCouponData=e.joinAs}if(e.skuCs&&e.skuCs.length>0){detailCoupon.bulidCouponByType(c,e.skuCs,1)}c.push("</div></div></dd></dl>")}if(c.length>0){$("#detailCoupon").html(c.join(""));$("#detailCoupon").show();detailCoupon.dynamicBindClick()}},bulidCouponByType:function(b,e,c){if(c==1){b.push('<div id="received_title" class="_title">可用券</div>');b.push('<ul id="ulReceived_id" class="_coupons_ul">')}if(c==0){b.push('<div id="unreceived_title" class="_title">可领券</div>');b.push('<ul id="ulUnreceived_id" class="_coupons_ul">')}var a="received";var d="unreceived";$(e).each(function(j,k){var i=k.url;var h;var g;var f;if(k.couponStyle==3&&k.discountInfo&&k.discountInfo.info){var l=k.discountInfo.info;
if(l.length==1){g=l[0].discount*10+"折";f=k.discountDesc}else{g=k.discountDesc;f="满"+l[0].quota+"可用"}}else{if(!k.quota||!k.couponType){g="￥"+k.discount;f=k.discountDesc}else{g="￥"+k.discount;f=k.discountDesc}}if(c==1){b.push(' <li class="received">');h=' <div class="_status"><a href="'+i+'" target="_blank">立即使用</a></div>'}else{b.push(' <li class="unreceived" id="vocher_item_'+j+'">');h=' <div class="_status"><a name="coupon_action" onclick="detailCoupon.checkVoucherCoupon(\''+j+"');\">立即领取</a></div>"}b.push(' <div class="_money">'+g+"</div>");b.push(' <div class="_condition">'+f+"</div>");b.push(h);b.push(' <div class="_gap"></div>');b.push(" </li>")});b.push("</ul>")},checkVoucherCoupon:function(a){loginRelated.checkLoginStatus(function(b){if(b){detailCoupon.loginStatus=false;detailCoupon.getVoucherCoupon(a)
}else{yhdPublicLogin.showLoginDivNone(URLPrefix.passport,false,"",function(c){if(c==0){yhdPublicLogin.showTopLoginInfo();detailCoupon.loginStatus=true;detailCoupon.init()}})}})},getVoucherCoupon:function(c){var a=detailCoupon.joinCouponData[c];var b=URLPrefix.detailDomainAjax+"/unitaryGetCoupon.do?key="+a.key+"&roleId="+a.roleId+"&eid="+fingerPrintUtil.getEid()+"&fp="+fingerPrintUtil.getUdFp()+"&callback=?";$.getJSON(b,function(f){$("#confirmVoucherCoupon").hide();$("#mask").hide();if(f&&f.data&&f.data.rtnCode=="34"){detailPublic.popmeun(".realname_check","#virtualBtnForRealName");var g=$(".realname_check");g.find(".pop_container p").text("此优惠券需要实名认证");g.find(".pop_btn  .cancel").text("放弃领券");$("#go_realname").attr("href","//home.yhd.com/safecenter/editIdentity.do?identitySource=identityProductDetail&callbackSuccUrl="+encodeURIComponent(window.location.href));
$("#virtualBtnForRealName").click();return}if(f&&!f.code&&f.data){var d=$("#vocher_item_"+c);var e=d.find(".getmask");e.show();setTimeout(function(){var h=a.url?a.url:"javascript:void(0);";e.hide();d.find("._status").find("a").attr({onclick:"",href:h,target:"_blank"});d.find("._status").find("a").text("立即使用");d.removeClass("unreceived");d.addClass("received")},2000);return}if(f&&f.data&&f.data.rtnMsg){yhdLib.alert(f.data.rtnMsg)}else{yhdLib.alert("很抱歉，没抢到~~")}});log("CouponYhd","PickCouponYhd","1",a.roleId,a.discountDesc)},getCounDesc:function(b,c){var a=0;$(c.joinAs).each(function(d,e){if(a==4){return}b.push('<div class="_item">'+e.discountDesc+"</div>");a++});$(c.skuCs).each(function(d,e){if(a==4){return}b.push('<div class="_item">'+e.discountDesc+"</div>");a++})},dynamicBindClick:function(){$(".container-coupons-detail ._default ._right").on("click",function(a){$(".container-coupons-detail").addClass("active");
a.stopPropagation()});$(".container-coupons-detail ._default_active ._right").on("click",function(a){$(".container-coupons-detail").removeClass("active");a.stopPropagation();detailCoupon.init()})},initFingerPrint:function(){fingerPrintUtil.shshshfpInit();fingerPrintUtil.eidInit()}};function getSkuPrice(b,d){var c={"params.area":cookieUtil.getYhdAreasCookie(),"params.skuIds":b};var a=URLPrefix.detailDomainAjax+"/getPrices.do";$.ajax({type:"get",url:a,dataType:"jsonp",data:c,jsonp:"callback",success:function(g){if(g&&g.data&&g.data.length>0){var e=g.data;for(var h=0;h<e.length;h++){var l=e[h];var k=$("#"+d);var f=k.find("[skuId='"+l.id+"']");if(l.p<0){console.log("商品价格刷新失败SKUID="+l.id);f.hide()}var j=f.find(".j_price");if(j){j.html(l.p)}}}else{$("#"+d).hide();console.log("flush price return null, area is="+d)}},error:function(){$("#"+d).hide();console.log("flush price error, area is ="+d)}})}function flushPrice(p){var a=$("#"+p);var m=$("[data-needReflushType='0']",a);var g=new Array();if(m){for(var e=0;e<m.length;e++){var o=$(m[e]).attr("skuId");if(o){g.push(o)}}}else{return
}var b=6;var h=Math.ceil(g.length/b);var f=new Array();for(var d=0;d<h;d++){var l="";if(d==(h-1)){if(h*b>=g.length){for(var c=d*b;c<g.length;c++){l=l+g[c]+","}}}else{for(var c=d*b;c<(d+1)*b;c++){l=l+g[c]+","}}getSkuPrice(l,p)}};var detail_yhdareas_cookie="yhd_location";var detail_yhdUsualAddress_cookie="yhd_coord";require.config({urlArgs:currVersionNum,paths:{detailProdDescImgPreview:URLPrefix.statics+"/detail/js/detailProdDescImgPreview",detailOneRobBuy:URLPrefix.statics+"/detail/js/detailOneRobBuy",detailPresell:URLPrefix.statics+"/detail/js/detailPresell",detailDeliveryService:URLPrefix.statics+"/detail/js/detailDeliveryService"},shim:{detailProdDescImgPreview:{deps:["css!"+URLPrefix.statics+"/detail/css/detailProdDescImgPreview.css"]}},map:{"*":{css:URLPrefix.statics+"/detail/js/jquery/css.js"}}});var detailRequireFunction={detailPresell:function(a){require(["detailPresell"],function(b){detailRequireFunction.printLog("detailPresell.init start");b.logic.init(a);detailRequireFunction.printLog("detailPresell.init end")
})},detailDeliveryService:function(){require(["detailDeliveryService"],function(a){detailRequireFunction.printLog("detailDeliveryService.init start");a.logic.init();detailRequireFunction.printLog("detailDeliveryService.init end")})},printLog:function(a){if(this.isPrintLog){console.log(a)}}};jQuery(document).ready(function(){areasSelectBox.init(a);detailProdPicture.init();detailPeExperience.getExperienceCountAndRate();detailSku.handleOneRobBuyProduct();detailSku.getProductTags();detailUtil.lazyLoadFunc("#descLazyLoad",function(){detailProdDesc.init()},-10);detailProdDesc.bindDescTabClick();detailSku.followProduct.init();function a(){detailSku.getStockAndPriceCheckLogin();detailCoupon.init();detailPromotion.init();colorSizeFn.init();detailProdCombine.ajaxProductCombineFit();detailPmsRecomm.ajaxPersonalizationPms("seeAndSee");
detailUtil.lazyLoadFunc("#leftLazyLoad",function(){detailPmsRecomm.ajaxPersonalizationPms("rankList");detailPmsRecomm.ajaxPersonalizationPms("finallyBuy");detailPmsRecomm.ajaxPersonalizationPms("buyAndBuy");detailVenderInfo.ajaxGetVenderInfo()},-10);if(detailParams.spAttr&&detailParams.spAttr.isFreeload==1){detailRequireFunction.detailDeliveryService()}btnStatusSet.collectSearchSelectPromParam()}function b(){var d=detailParams.pName;$("#productMainName").attr("title",d);if(!detailParams.isPop){$("#productMainName").html('<span class="self_icon">自营</span>'+d)}else{$("#productMainName").html(d)}}var c=c||[];c.push(["account","JA2017_111805"]);c.push(["domain","yhd.com"]);(function(){var d=document.createElement("script");d.type="text/javascript";d.async=true;d.src="//wl.jd.com/joya.js";var e=document.getElementsByTagName("script")[0];
e.parentNode.insertBefore(d,e)})()});var reserveBuy={reserveType:null,userHasDate:null,userHasQualification:null,init:function(a){reserveBuy.loadReserveInfo(reserveBuy.initReserveProd,a)},loadReserveInfo:function(d,a){var c={"params.skuId":detailParams.skuId};var b=URLPrefix.detailDomainAjax+"/getReserveInfo.do";$.ajax({type:"get",url:b,dataType:"jsonp",data:c,timeout:3000,jsonp:"callback",success:function(e){if(e&&e.data&&e.message&&e.message=="success"){if(typeof d=="function"){d(e)}}else{if(typeof a=="function"){a()}}},error:function(){if(typeof a=="function"){a()}console.log("getReserveInfo error")}})},resetReserveProd:function(a){var b=a.data;reserveBuy.userHasDate=b.userHasDate;reserveBuy.userHasQualification=b.userHasQualification;reserveBuy.panicAddCart()},initReserveProd:function(s){var t=s.data;var a=t.autoAddCart;var p=t.curSystemDate;
var r=t.desc;var d=t.endTime;var m=t.id;var b=t.panicbuyingStartTime;var h=t.panicbuyingEndTime;var j=t.reserveDiscountPrice;var c=t.reserveMemberNumber;var f=t.skuId;var k=t.startTime;var u=t.statusStr;reserveBuy.reserveType=t.type;reserveBuy.userHasDate=t.userHasDate;reserveBuy.userHasQualification=t.userHasQualification;$("#currentPriceArea").hide();$("#reserveBanner").show();$("#reserveBanner_ext").show();if(c==0&&u=="2"){$("#reserveBanner_rnum").html("预约中")}else{$("#reserveBanner_rnum").html(c+"人已预约")}$("#reservePriceArea").show();detailSku.showPrice(function(x){var w=x.p;var v=x.type;if(v==1){$("#reserveCommonPriceLabel").html("价格");$("#reserveCommonPrice").css("font-size","20px").html("¥"+x.msg)}else{if(reserveBuy.reserveType==3&&j!=null&&reserveBuy.userHasDate==true){$("#reserveCommonPriceLabel").html("预约价");
if(typeof(j)=="number"){$("#reserveCommonPrice").html("¥"+(j).toFixed(2))}else{$("#reserveCommonPrice").html("¥"+j)}$("#reserveOldPrice").html("1号店价：¥"+w).show()}else{$("#reserveCommonPriceLabel").html("价格");$("#reserveCommonPrice").html("<em>¥</em>"+w)}}},null);var e=$("#reserveIntro");e.find(".iconDetail-con").html(r.replace(/\n/g,"<br/>"));e.hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});detailPublic.popmeun(".book_popup","#virtualBtnForPopmeun");var g=null;if(k!=null){g=new Date(k)}var i=null;if(d!=null){i=new Date(d)}var q=new Date().getTime();if(p!=null&&p!=""){q=p}var n=null;if(b!=null){n=new Date(b)}var o=null;if(h!=null){o=new Date(h)}var l=reserveBuy.fillTimeRange(g,i,n,o);if(u=="1"){$("#reserveBanner_ext").find("ol").removeClass("step1");$("#reserveBanner_rnum").html("");
reserveBuy.reserveCountDownInit(g,q,i,"预约");reserveBuy.resetAddCartStauts(u)}else{if(u=="2"){reserveBuy.reserveCountDownInit(g,q,i,"预约");reserveBuy.resetAddCartStauts(u);$("#nowPanicBtn").bind("click",function(){loginRelated.checkAndLogin(function(){reserveBuy.addReserveQualification(l,a)})})}else{if(u=="3"){$("#reserveBanner_ext").find("ol").removeClass("step1");reserveBuy.reserveCountDownInit(n,q,o,"抢购");reserveBuy.resetAddCartStauts(u)}else{if(u=="4"){$("#reserveBanner_ext").find("ol").removeClass("step1");$("#reserveBanner_ext").find("ol").addClass("step2");reserveBuy.reserveCountDownInit(n,q,o,"抢购");if(detailSku.panicnNoGoods==-1){reserveBuy.resetAddCartStauts(u+"_1")}else{if(detailSku.mobileKo&&detailSku.mobileKo.status){btnStatusSet.realNameEvent();btnStatusSet.seckillCartEvent(function(){reserveBuy.loadReserveInfo(reserveBuy.resetReserveProd)
})}else{reserveBuy.resetAddCartStauts(u);$("#nowPanicBtn").bind("click",function(){loginRelated.checkAndLogin(function(){reserveBuy.loadReserveInfo(function(v){reserveBuy.resetReserveProd(v)})})})}}}else{if(u=="5"){$("#reserveBanner_ext").hide();$("#reserveBanner_rnum").html("");$("#reserveStartTime").hide();$("#reserveCountDown").show();$("#reserveCountDown").html("抢购已结束");reserveBuy.resetAddCartStauts(u)}else{$("#reserveBanner").hide();$("#reserveBanner_ext").hide();$("#reserveBanner_rnum").html("");if(typeof errCallback=="function"){errCallback()}}}}}}},panicAddCart:function(){if(reserveBuy.reserveType==1){if(!reserveBuy.userHasDate){$("#addReserveDetail").hide();$(".order_success_icon").css("background-image","url()");$("#addReserveMsg").html("该商品需要提前预约，很遗憾您没有购买资格。");$("#virtualBtnForPopmeun").click();
return}else{if(typeof(reserveBuy.userHasQualification)!="undefined"&&!reserveBuy.userHasQualification){$("#addReserveDetail").hide();$(".order_success_icon").css("background-image","url()");$("#addReserveMsg").html("该商品需要提前预约，很遗憾您没有购买资格。");$("#virtualBtnForPopmeun").click();return}}}if(detailSku.mobileKo&&detailSku.mobileKo.status){window.location=detailSku.mobileKo.seckillUrl}else{var a=btnStatusSet.handleDidParam();require(["common_cart"],function(c){var b={pid:detailParams.skuId,ptype:"1",pcount:$("#product_amount").val(),sku:"",did:a,zids:"",gids:"",targetId:btnStatusSet.targetId};c.addToCart(b)})}},fillTimeRange:function(e,a,b,d){if(e==null||a==null){$("#reserveTimeRange").html(" 待发布 ")}else{$("#reserveTimeRange").html(timeUtil.format([e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes()],["/","/"," ",":",""])+" 至 "+timeUtil.format([a.getFullYear(),a.getMonth()+1,a.getDate(),a.getHours(),a.getMinutes()],["/","/"," ",":",""]))
}var c="";if(b==null||d==null){$("#panicTimeRange").html(" 待发布 ")}else{c=timeUtil.format([b.getFullYear(),b.getMonth()+1,b.getDate(),b.getHours(),b.getMinutes()],["/","/"," ",":",""]);$("#panicTimeRange").html(c+" 至 "+timeUtil.format([d.getFullYear(),d.getMonth()+1,d.getDate(),d.getHours(),d.getMinutes()],["/","/"," ",":",""]))}return c},resetAddCartStauts:function(a){if(a==""){return}var b=$("#nowPanicBtn");b.unbind();detailSku.resetBtnStauts();if(jQuery("#nowPanicBtn").size()>0){jQuery("#nowPanicBtn").hide()}b.addClass("btn_init_class");b.attr("btn_init_flag","1");switch(a){case"1":b.removeClass("buy_btn9");b.removeClass("noticebtn");b.addClass("buy_btn3");b.html("<span>等待预约</span>");btnStatusSet.realNameEvent();break;case"2":b.addClass("buy_btn9");b.addClass("noticebtn");b.removeClass("buy_btn3");
b.html("<span>立即预约</span>");btnStatusSet.realNameEvent();break;case"3":b.removeClass("buy_btn9");b.removeClass("noticebtn");b.addClass("buy_btn3");b.html("<span>等待抢购</span>");btnStatusSet.realNameEvent();break;case"4":b.addClass("buy_btn9");b.addClass("noticebtn");b.removeClass("buy_btn3");b.html("<span>立即抢购</span>");break;case"4_1":b.removeClass("buy_btn9");b.removeClass("noticebtn");b.addClass("buy_btn3");b.html("<span>已抢光</span>");break;case"5":b.removeClass("buy_btn9");b.removeClass("noticebtn");b.addClass("buy_btn3");b.html("<span>抢购已结束</span>");break}b.show()},reserveCountDownInit:function(f,a,c,h){var b=0;var g=0;if(f!=null){b=f.getTime()}if(c!=null){g=c.getTime()}if(a<b){var d=new Date(b);$("#reserveBanner").show();$("#reserveCountDown").hide();if(b!=0){$("#reserveStartTime").show();
var e=setInterval(function(){var j=null;if((b-a)<3600000*24){$("#reserveStartTime").hide();$("#reserveCountDown").show();j=timeUtil.format(timeUtil.sub(a,b),["</em> 时 <em>","</em> 分 <em>","</em> 秒"])}else{$("#reserveCountDown").hide();$("#reserveStartTime").html("<b>"+timeUtil.format([d.getFullYear(),d.getMonth()+1,d.getDate(),d.getHours(),d.getMinutes()],["</b>年<b>","</b>月<b>","</b>日<b>","</b>:<b>",""])+"</b> 开始"+h).show()}if(a>=b){$("#reserveCountDown").html("<em>00</em> 时 <em>00</em> 分 <em>00</em> 秒后&nbsp;&nbsp;开始"+h);window.clearInterval(e);window.location.reload()}else{$("#reserveCountDown").html("<em>"+j+"后&nbsp;&nbsp;开始"+h)}a=a+1000},1000)}}else{var i=new Date(g);$("#reserveBanner").show();$("#reserveStartTime").hide();if(g!=0){$("#reserveCountDown").show();var e=setInterval(function(){var j=null;
if((g-a)<3600000*24){j=timeUtil.format(timeUtil.sub(a,g),["</em> 时 <em>","</em> 分 <em>","</em> 秒"])}else{$("#reserveCountDown").hide();$("#reserveStartTime").html("<b>"+timeUtil.format([i.getFullYear(),i.getMonth()+1,i.getDate(),i.getHours(),i.getMinutes()],["</b>年<b>","</b>月<b>","</b>日<b>","</b>:<b>",""])+"</b> "+h+"结束").show()}if(a>=g){$("#reserveCountDown").html("<em>00</em> 时 <em>00</em> 分 <em>00</em> 秒后&nbsp;&nbsp;"+h+"结束");window.clearInterval(e);window.location.reload()}else{$("#reserveCountDown").html("<em>"+j+"后&nbsp;&nbsp;"+h+"结束")}a=a+1000},1000)}}},addReserveQualification:function(c,e){var b=detailParams.spAttr;if(b.isYuYue==0){return}else{}var d={"params.skuId":detailParams.skuId};var a=URLPrefix.detailDomainAjax+"/addReserveQualification.do";$.ajax({type:"get",url:a,dataType:"jsonp",data:d,jsonp:"callback",success:function(h){if(h){if(h.data&&h.message&&h.message=="success"){var j=h.data;
var f=j.rtnCode;var g=j.rtnData;var i=j.rtnMsg;$("#addReserveDetail").show();if(c==null||c==""){$("#addReserveDetail").hide()}else{$("#addReservePanicStartTime").html(c)}if(f=="-1"){$("#addReserveMsg").html("您已预约成功，无需重复预约");$("#virtualBtnForPopmeun").click()}if(f=="0"){if(e==true){require(["common_cart"],function(n){var k=btnStatusSet.handleDidParam();var m={pid:detailParams.skuId,ptype:"1",pcount:$("#product_amount").val(),sku:"",did:k,zids:"",gids:"",targetId:btnStatusSet.targetId};var l={addToCartSuccess:function(){$("#addReserveMsg").html("恭喜您预约成功！商品已帮您加入购物车。");$("#virtualBtnForPopmeun").click()},addToCartError:function(o){$("#addReserveMsg").html("恭喜，预约成功!");$("#virtualBtnForPopmeun").click()}};n.addToCart(m,l)})}else{$("#addReserveMsg").html("恭喜，预约成功!");$("#virtualBtnForPopmeun").click()
}}if(f!="0"&&f!="-1"){$(".order_success_icon").css("background-image","url()");$("#addReserveMsg").html("预约失败");$("#addReserveDetail").hide();$("#virtualBtnForPopmeun").click()}}else{}}},error:function(){}})}};